<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>layout 后台大布局 - Layui</title>
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css">
    <link rel="stylesheet" href="/css/layui-common.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/scientificPlatform.css">
    <style>
        .item-details-img .img-box{background: none}
        .bg-blue-box{margin:0;}
        .layui-tab-content{padding: 10px 0}
        .layui-table-view .layui-table,.layui-table-box tr.layui-none{width: 100% !important;}
    </style>
</head>
<body>
<form class="layui-form" action="" id="formPlatform" lay-filter="formPlatform">
    <div class="layout-view-content">
        <div class="item-banner-view">
            <div class="item-details-img middle-block">
                <div class="img-box ib-block" id="img"><img src="/layuiadmin/layui/images/expert-img.png"/> </div>
                <div class="text-box ib-block">
                    <div class="title" diy-form-value="name"></div>
                    <ul class="text-list">
                        <li class="font16"><span class="label-text">职称：</span><span class="label-value" diy-form-value="titleStr"></span></li>
                        <li class="font16"><span class="label-text">职务：</span><span class="label-value" diy-form-value="post"></span></li>
                        <li class="font16"><span class="label-text">技术领域：</span><span class="label-value" diy-form-value="technicalFieldName"></span></li>
                        <li class="font16"><span class="label-text">学历：</span><span class="label-value" diy-form-value="educationStr"></span></li>
                        <li class="font16"><span class="label-text">所在单位：</span><span class="label-value" diy-form-value="belongUnitStr">中核科技有限公司</span></li>
                    </ul>
                </div>
            </div>
            <div class="item-details-list middle-block">
                <div class="item-box-list middle-block">
                    <div class="icon-item ib-block icon001"></div>
                    <div class="item-text  ib-block font16">相关项目<span class="font20" diy-form-value="project"></span>个</div>
                </div>
                <div class="item-box-list middle-block">
                    <div class="icon-item  ib-block icon003"></div>
                    <div class="item-text  ib-block font16">相关成果<span class="font20" diy-form-value="achievementNum"></span>个</div>
                </div>
                <div class="item-box-list middle-block">
                    <div class="icon-item  ib-block icon002"></div>
                    <div class="item-text  ib-block font16">相关奖励<span class="font20" diy-form-value="reward"></span>个</div>
                </div>
                <div class="item-box-list middle-block">
                    <div class="icon-item  ib-block icon004"></div>
                    <div class="item-text  ib-block font16">专利数量<span class="font20" diy-form-value="patent"></span>个</div>
                </div>
            </div>
        </div>

        <div class="layui-tab" lay-filter="gjj_kyxq">
            <ul class="layui-tab-title tab-btn-layout">
                <li class="layui-this">人物简介</li>
                <li>人物成就</li>
                <li>相关项目</li>
                <li>成果信息</li>
                <li>专利信息</li>
                <li>奖励信息</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                    <!-- 人物简介 -->
                    <div class="bg-blue-box">
                        <div class="bg-blue-title font20" diy-form-value="name"></div>
                        <div class="bg-blue-p" diy-form-value="brief"></div>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <!-- 人物成就 -->
                    <div class="bg-blue-box">
                        <div class="bg-blue-title font20" diy-form-value="name"></div>
                        <div class="bg-blue-p" diy-form-value="achievement"></div>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <!-- 项目 -->
                    <table id="project"></table>
                </div>
                <div class="layui-tab-item">
                    <!-- 成果信息 -->
                    <table id="achievements"></table>
                </div>
                <div class="layui-tab-item">
                    <!-- 专利信息 -->
                    <table id="patent"></table>
                </div>
                <div class="layui-tab-item">
                    <!-- 奖励信息 -->
                    <table id="reward"></table>
                </div>

            </div>
        </div>
    </div>
</form>
<script type="text/javascript" src="/plugins/jQuery/jQuery-2.2.0.min.js"></script>
<script src="/layuiadmin/layui/layui.js"></script>
<script src="/layuiadmin/js/common.js"></script>
<script>
    //Demo
    layui.use(['form', 'table', 'layer', 'element'], function(){
        var form = layui.form,$ = layui.$,table = layui.table, element = layui.element;
        // 获取页面参数ID
        var variable = getQueryVariable();
        if(variable!=null){
            httpModule({
                url: '/expert-api/get/'+variable.id,
                type: 'GET',
                success: function(relData) {
                    if (relData.success === true) {
                        relData.data.achievementNum=JSON.parse(relData.data.zjkAchievementJsonList).length
                        relData.data.patent=JSON.parse(relData.data.zjkPatentJsonList).length
                        relData.data.project=JSON.parse(relData.data.zjkProjectJsonList).length
                        relData.data.reward=JSON.parse(relData.data.zjkRewardJsonList).length
                        if(relData.data.headPic!=''){
                            console.log(relData.data.headPic)
                            $("#img img").attr("src",'/file/imgFile/'+relData.data.headPic)
                        }
                        setTargetNameValue(relData.data)
                    }
                }
            });
        }
        $(".label-value").eq(2).hover(function () {
            $(this).attr("title",$(this).html())
        })
        var projectArr=[
            {title: '序号',type:'numbers',width:55 },
            {field: 'projectName', title: '项目名称'},
            {field: 'chargeUnitStr', title: '负责单位'},
            {field: 'researchTarget', title: '研究目标' },
            {field: 'setupYeat', title: '立项年度'},
        ]
        tableRender('project',projectArr,'/expert-project-api/list',variable.id)
        var achievementsArr=[
            {title: '序号',type:'numbers',width:55 },
            {field: 'achieveName', title: '成果名称'},
            {field: 'applyUnitStr', title: '申请单位'},
            {field: 'achieveTypeStr', title: '成果类别' },
            {field: 'applyYear', title: '申请年度'},
        ]
        tableRender('achievements',achievementsArr,'/expert-achievement-api/list',variable.id)
        var patentArr=[
            {title: '序号',type:'numbers' ,width:55},
            {field: 'patentName', title: '专利名称'},
            {field: 'patentTypeStr', title: '专利类型'},
            {field: 'getPatentTimeStr', title: '申请日期' },
            {field: 'describe', title: '专利描述'},
        ]
        tableRender('patent',patentArr,'/expert-patent-api/list',variable.id)
        var rewardArr=[
            {title: '序号',type:'numbers',width:55 },
            {field: 'rewarkLevelStr', title: '奖励级别'},
            {field: 'notes', title: '奖励描述'},
            {field: 'awardingUnit', title: '授奖单位' },
            {field: 'awardingTimeStr', title: '获奖日期'},
        ]
        tableRender('reward',rewardArr,'/expert-reward-api/list',variable.id)
        function tableRender(id,cols,url,where) {
            table.render({
                elem: '#'+id // 表格元素ID
                ,url:url //数据接口
                ,cols: [cols],
                method: 'post', // 数据请求接口类型 默认 get, 如果是get 可以去掉此项
                where: {
                    useID: 'admin' // 表格请求时传递的参数
                    ,expertId:where
                    //  默认请求参数 页码 => page, 每页条数 => limit
                }
                ,request: {
                    page: 'pageIndex', // 重置默认分页请求请求参数 page => pageIndex
                    limit: 'pageSize' // 重置默认分页请求请求参数 limit => pageSize
                },
                done:function (res, curr, count) {
                    //console.log(res)
                }
                , page: true //开启分页
                , limit: 15
                , limits: [15, 30, 45, 60], // 配置分页数据条数
            });
        }

    });
</script>
</body>
</html>