<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pcitc.mapper.system.SysUnitMapper">
  <resultMap id="BaseResultMap" type="com.pcitc.base.system.SysUnit">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    <id column="unit_id" jdbcType="VARCHAR" property="unitId" />
    <result column="unit_name" jdbcType="VARCHAR" property="unitName" />
    <result column="unit_abbr" jdbcType="VARCHAR" property="unitAbbr" />
    <result column="unit_code" jdbcType="VARCHAR" property="unitCode" />
    <result column="unit_flag" jdbcType="VARCHAR" property="unitFlag" />
    <result column="unit_kind" jdbcType="VARCHAR" property="unitKind" />
    <result column="unit_create_time" jdbcType="TIMESTAMP" property="unitCreateTime" />
    <result column="unit_extend" jdbcType="VARCHAR" property="unitExtend" />
    <result column="unit_order" jdbcType="INTEGER" property="unitOrder" />
    <result column="unit_comment" jdbcType="VARCHAR" property="unitComment" />
    <result column="unit_phone" jdbcType="VARCHAR" property="unitPhone" />
    <result column="unit_fax" jdbcType="VARCHAR" property="unitFax" />
    <result column="unit_manager" jdbcType="VARCHAR" property="unitManager" />
    <result column="unit_address" jdbcType="VARCHAR" property="unitAddress" />
    <result column="unit_control" jdbcType="VARCHAR" property="unitControl" />
    <result column="unit_account" jdbcType="VARCHAR" property="unitAccount" />
    <result column="unit_delflag" jdbcType="INTEGER" property="unitDelflag" />
    <result column="unit_level" jdbcType="INTEGER" property="unitLevel" />
    <result column="unit_relation" jdbcType="VARCHAR" property="unitRelation" />
    <result column="unit_path" jdbcType="VARCHAR" property="unitPath" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    unit_id, unit_name, unit_abbr, unit_code, unit_flag, unit_kind, unit_create_time, 
    unit_extend, unit_order, unit_comment, unit_phone, unit_fax, unit_manager, unit_address, 
    unit_control, unit_account, unit_delflag, unit_level, unit_relation, unit_path
  </sql>
  <select id="selectByExample" parameterType="com.pcitc.base.system.SysUnitExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    'true' as QUERYID,
    <include refid="Base_Column_List" />
    from sys_unit
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from sys_unit
    where unit_id = #{unitId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    delete from sys_unit
    where unit_id = #{unitId,jdbcType=VARCHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.pcitc.base.system.SysUnitExample">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    delete from sys_unit
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.pcitc.base.system.SysUnit">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    insert into sys_unit (unit_id, unit_name, unit_abbr, 
      unit_code, unit_flag, unit_kind, 
      unit_create_time, unit_extend, unit_order, 
      unit_comment, unit_phone, unit_fax, 
      unit_manager, unit_address, unit_control, 
      unit_account, unit_delflag, unit_level, 
      unit_relation, unit_path)
    values (#{unitId,jdbcType=VARCHAR}, #{unitName,jdbcType=VARCHAR}, #{unitAbbr,jdbcType=VARCHAR}, 
      #{unitCode,jdbcType=VARCHAR}, #{unitFlag,jdbcType=VARCHAR}, #{unitKind,jdbcType=VARCHAR}, 
      #{unitCreateTime,jdbcType=TIMESTAMP}, #{unitExtend,jdbcType=VARCHAR}, #{unitOrder,jdbcType=INTEGER}, 
      #{unitComment,jdbcType=VARCHAR}, #{unitPhone,jdbcType=VARCHAR}, #{unitFax,jdbcType=VARCHAR}, 
      #{unitManager,jdbcType=VARCHAR}, #{unitAddress,jdbcType=VARCHAR}, #{unitControl,jdbcType=VARCHAR}, 
      #{unitAccount,jdbcType=VARCHAR}, #{unitDelflag,jdbcType=INTEGER}, #{unitLevel,jdbcType=INTEGER}, 
      #{unitRelation,jdbcType=VARCHAR}, #{unitPath,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.pcitc.base.system.SysUnit">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    insert into sys_unit
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="unitId != null">
        unit_id,
      </if>
      <if test="unitName != null">
        unit_name,
      </if>
      <if test="unitAbbr != null">
        unit_abbr,
      </if>
      <if test="unitCode != null">
        unit_code,
      </if>
      <if test="unitFlag != null">
        unit_flag,
      </if>
      <if test="unitKind != null">
        unit_kind,
      </if>
      <if test="unitCreateTime != null">
        unit_create_time,
      </if>
      <if test="unitExtend != null">
        unit_extend,
      </if>
      <if test="unitOrder != null">
        unit_order,
      </if>
      <if test="unitComment != null">
        unit_comment,
      </if>
      <if test="unitPhone != null">
        unit_phone,
      </if>
      <if test="unitFax != null">
        unit_fax,
      </if>
      <if test="unitManager != null">
        unit_manager,
      </if>
      <if test="unitAddress != null">
        unit_address,
      </if>
      <if test="unitControl != null">
        unit_control,
      </if>
      <if test="unitAccount != null">
        unit_account,
      </if>
      <if test="unitDelflag != null">
        unit_delflag,
      </if>
      <if test="unitLevel != null">
        unit_level,
      </if>
      <if test="unitRelation != null">
        unit_relation,
      </if>
      <if test="unitPath != null">
        unit_path,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="unitId != null">
        #{unitId,jdbcType=VARCHAR},
      </if>
      <if test="unitName != null">
        #{unitName,jdbcType=VARCHAR},
      </if>
      <if test="unitAbbr != null">
        #{unitAbbr,jdbcType=VARCHAR},
      </if>
      <if test="unitCode != null">
        #{unitCode,jdbcType=VARCHAR},
      </if>
      <if test="unitFlag != null">
        #{unitFlag,jdbcType=VARCHAR},
      </if>
      <if test="unitKind != null">
        #{unitKind,jdbcType=VARCHAR},
      </if>
      <if test="unitCreateTime != null">
        #{unitCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="unitExtend != null">
        #{unitExtend,jdbcType=VARCHAR},
      </if>
      <if test="unitOrder != null">
        #{unitOrder,jdbcType=INTEGER},
      </if>
      <if test="unitComment != null">
        #{unitComment,jdbcType=VARCHAR},
      </if>
      <if test="unitPhone != null">
        #{unitPhone,jdbcType=VARCHAR},
      </if>
      <if test="unitFax != null">
        #{unitFax,jdbcType=VARCHAR},
      </if>
      <if test="unitManager != null">
        #{unitManager,jdbcType=VARCHAR},
      </if>
      <if test="unitAddress != null">
        #{unitAddress,jdbcType=VARCHAR},
      </if>
      <if test="unitControl != null">
        #{unitControl,jdbcType=VARCHAR},
      </if>
      <if test="unitAccount != null">
        #{unitAccount,jdbcType=VARCHAR},
      </if>
      <if test="unitDelflag != null">
        #{unitDelflag,jdbcType=INTEGER},
      </if>
      <if test="unitLevel != null">
        #{unitLevel,jdbcType=INTEGER},
      </if>
      <if test="unitRelation != null">
        #{unitRelation,jdbcType=VARCHAR},
      </if>
      <if test="unitPath != null">
        #{unitPath,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.pcitc.base.system.SysUnitExample" resultType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    select count(*) from sys_unit
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    update sys_unit
    <set>
      <if test="record.unitId != null">
        unit_id = #{record.unitId,jdbcType=VARCHAR},
      </if>
      <if test="record.unitName != null">
        unit_name = #{record.unitName,jdbcType=VARCHAR},
      </if>
      <if test="record.unitAbbr != null">
        unit_abbr = #{record.unitAbbr,jdbcType=VARCHAR},
      </if>
      <if test="record.unitCode != null">
        unit_code = #{record.unitCode,jdbcType=VARCHAR},
      </if>
      <if test="record.unitFlag != null">
        unit_flag = #{record.unitFlag,jdbcType=VARCHAR},
      </if>
      <if test="record.unitKind != null">
        unit_kind = #{record.unitKind,jdbcType=VARCHAR},
      </if>
      <if test="record.unitCreateTime != null">
        unit_create_time = #{record.unitCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.unitExtend != null">
        unit_extend = #{record.unitExtend,jdbcType=VARCHAR},
      </if>
      <if test="record.unitOrder != null">
        unit_order = #{record.unitOrder,jdbcType=INTEGER},
      </if>
      <if test="record.unitComment != null">
        unit_comment = #{record.unitComment,jdbcType=VARCHAR},
      </if>
      <if test="record.unitPhone != null">
        unit_phone = #{record.unitPhone,jdbcType=VARCHAR},
      </if>
      <if test="record.unitFax != null">
        unit_fax = #{record.unitFax,jdbcType=VARCHAR},
      </if>
      <if test="record.unitManager != null">
        unit_manager = #{record.unitManager,jdbcType=VARCHAR},
      </if>
      <if test="record.unitAddress != null">
        unit_address = #{record.unitAddress,jdbcType=VARCHAR},
      </if>
      <if test="record.unitControl != null">
        unit_control = #{record.unitControl,jdbcType=VARCHAR},
      </if>
      <if test="record.unitAccount != null">
        unit_account = #{record.unitAccount,jdbcType=VARCHAR},
      </if>
      <if test="record.unitDelflag != null">
        unit_delflag = #{record.unitDelflag,jdbcType=INTEGER},
      </if>
      <if test="record.unitLevel != null">
        unit_level = #{record.unitLevel,jdbcType=INTEGER},
      </if>
      <if test="record.unitRelation != null">
        unit_relation = #{record.unitRelation,jdbcType=VARCHAR},
      </if>
      <if test="record.unitPath != null">
        unit_path = #{record.unitPath,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    update sys_unit
    set unit_id = #{record.unitId,jdbcType=VARCHAR},
      unit_name = #{record.unitName,jdbcType=VARCHAR},
      unit_abbr = #{record.unitAbbr,jdbcType=VARCHAR},
      unit_code = #{record.unitCode,jdbcType=VARCHAR},
      unit_flag = #{record.unitFlag,jdbcType=VARCHAR},
      unit_kind = #{record.unitKind,jdbcType=VARCHAR},
      unit_create_time = #{record.unitCreateTime,jdbcType=TIMESTAMP},
      unit_extend = #{record.unitExtend,jdbcType=VARCHAR},
      unit_order = #{record.unitOrder,jdbcType=INTEGER},
      unit_comment = #{record.unitComment,jdbcType=VARCHAR},
      unit_phone = #{record.unitPhone,jdbcType=VARCHAR},
      unit_fax = #{record.unitFax,jdbcType=VARCHAR},
      unit_manager = #{record.unitManager,jdbcType=VARCHAR},
      unit_address = #{record.unitAddress,jdbcType=VARCHAR},
      unit_control = #{record.unitControl,jdbcType=VARCHAR},
      unit_account = #{record.unitAccount,jdbcType=VARCHAR},
      unit_delflag = #{record.unitDelflag,jdbcType=INTEGER},
      unit_level = #{record.unitLevel,jdbcType=INTEGER},
      unit_relation = #{record.unitRelation,jdbcType=VARCHAR},
      unit_path = #{record.unitPath,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.pcitc.base.system.SysUnit">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    update sys_unit
    <set>
      <if test="unitName != null">
        unit_name = #{unitName,jdbcType=VARCHAR},
      </if>
      <if test="unitAbbr != null">
        unit_abbr = #{unitAbbr,jdbcType=VARCHAR},
      </if>
      <if test="unitCode != null">
        unit_code = #{unitCode,jdbcType=VARCHAR},
      </if>
      <if test="unitFlag != null">
        unit_flag = #{unitFlag,jdbcType=VARCHAR},
      </if>
      <if test="unitKind != null">
        unit_kind = #{unitKind,jdbcType=VARCHAR},
      </if>
      <if test="unitCreateTime != null">
        unit_create_time = #{unitCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="unitExtend != null">
        unit_extend = #{unitExtend,jdbcType=VARCHAR},
      </if>
      <if test="unitOrder != null">
        unit_order = #{unitOrder,jdbcType=INTEGER},
      </if>
      <if test="unitComment != null">
        unit_comment = #{unitComment,jdbcType=VARCHAR},
      </if>
      <if test="unitPhone != null">
        unit_phone = #{unitPhone,jdbcType=VARCHAR},
      </if>
      <if test="unitFax != null">
        unit_fax = #{unitFax,jdbcType=VARCHAR},
      </if>
      <if test="unitManager != null">
        unit_manager = #{unitManager,jdbcType=VARCHAR},
      </if>
      <if test="unitAddress != null">
        unit_address = #{unitAddress,jdbcType=VARCHAR},
      </if>
      <if test="unitControl != null">
        unit_control = #{unitControl,jdbcType=VARCHAR},
      </if>
      <if test="unitAccount != null">
        unit_account = #{unitAccount,jdbcType=VARCHAR},
      </if>
      <if test="unitDelflag != null">
        unit_delflag = #{unitDelflag,jdbcType=INTEGER},
      </if>
      <if test="unitLevel != null">
        unit_level = #{unitLevel,jdbcType=INTEGER},
      </if>
      <if test="unitRelation != null">
        unit_relation = #{unitRelation,jdbcType=VARCHAR},
      </if>
      <if test="unitPath != null">
        unit_path = #{unitPath,jdbcType=VARCHAR},
      </if>
    </set>
    where unit_id = #{unitId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.pcitc.base.system.SysUnit">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 16:40:44 CST 2018.
    -->
    update sys_unit
    set unit_name = #{unitName,jdbcType=VARCHAR},
      unit_abbr = #{unitAbbr,jdbcType=VARCHAR},
      unit_code = #{unitCode,jdbcType=VARCHAR},
      unit_flag = #{unitFlag,jdbcType=VARCHAR},
      unit_kind = #{unitKind,jdbcType=VARCHAR},
      unit_create_time = #{unitCreateTime,jdbcType=TIMESTAMP},
      unit_extend = #{unitExtend,jdbcType=VARCHAR},
      unit_order = #{unitOrder,jdbcType=INTEGER},
      unit_comment = #{unitComment,jdbcType=VARCHAR},
      unit_phone = #{unitPhone,jdbcType=VARCHAR},
      unit_fax = #{unitFax,jdbcType=VARCHAR},
      unit_manager = #{unitManager,jdbcType=VARCHAR},
      unit_address = #{unitAddress,jdbcType=VARCHAR},
      unit_control = #{unitControl,jdbcType=VARCHAR},
      unit_account = #{unitAccount,jdbcType=VARCHAR},
      unit_delflag = #{unitDelflag,jdbcType=INTEGER},
      unit_level = #{unitLevel,jdbcType=INTEGER},
      unit_relation = #{unitRelation,jdbcType=VARCHAR},
      unit_path = #{unitPath,jdbcType=VARCHAR}
    where unit_id = #{unitId,jdbcType=VARCHAR}
  </update>
  
  <!-- 部门树所有节点 -->
  <select id="getUnitTree" resultType="com.pcitc.base.common.TreeNode">
	  select distinct u.unit_id as id,u.unit_name as text,u.unit_code as code,u.unit_relation as parentId from sys_unit u 
		left join sys_unit u1 on u.unit_id = u1.unit_relation
		left join sys_unit u2 on u1.unit_id = u2.unit_relation
		left join sys_unit u3 on u2.unit_id = u3.unit_relation
		left join sys_unit u4 on u3.unit_id = u4.unit_relation
  </select>
  
  <!-- 查询列表 -->
  <select id="selectUnitList" resultMap="BaseResultMap">
	  select unit_id, unit_name,unit_code
	  from sys_unit
  </select>
  
  <!-- 组织机构树, 有组织机构和人员, 没有岗位  查询某些组织机构节点的组织机构树,同时查询直系父辈-->
  <select id="getUnitTreeAndUserByUnitCodes" parameterType="java.util.Map" resultType="com.pcitc.base.common.TreeNode">
	  select u.unit_id as id, u.unit_name as name,u.unit_relation as pid,u.unit_code as code, 'unit' as nodeType,
	  u.unit_level as levelCode
	  from sys_unit u 
	  where unit_delflag = 0 
	  	and (
	  	    (
	  	    	<foreach collection="unitCodes" item="unitCode" index="index" separator="OR">
			      unit_code like '${unitCode}%'
			    </foreach>
	  	    ) or (
	  	    	<foreach collection="unitParentCodes" item="unitParentCode" index="index" separator="OR">
			      unit_code = '${unitParentCode}'
			    </foreach>
	  	    )
	  	)
	  union all 
	  select sys_user.user_id as id, sys_user.user_disp as name, sys_user_unit.unit_id as pid, sys_user.user_name as code, 
	         'user' as nodeType,20 as levelCode
	  from sys_user,sys_user_unit
	  where user_delflag = 0 and sys_user.user_id = sys_user_unit.user_id
	        and sys_user_unit.unit_id in (
	  		  select u.unit_id
			  from sys_unit u 
			  where unit_delflag = 0 
			  	and 
			  	    (
			  	    	<foreach collection="unitCodes" item="unitCode" index="index" separator="OR">
					      unit_code like '${unitCode}%'
					    </foreach>
			  	    ) 
	  )
  </select>
  
  <!-- 通过某几个岗位编码获取这几个岗位的全部其他信息和所属人员信息 -->
  <select id="getPostInfoByPostCodes" parameterType="java.util.Map" resultType="com.pcitc.base.common.TreeNode">
	  select sys_post.post_id as id, sys_post.post_name as name,sys_post.post_unit as pid,sys_post.post_code as code, 
	         'post' as nodeType,sys_unit.unit_path as nodePath,sys_post.post_level as levelCode
	  from sys_post,sys_unit
	  where sys_post.post_delflag = 0 and sys_post.post_unit=sys_unit.unit_id
	  	and 
	  	    (
	  	    	<foreach collection="postCodes" item="postCode" index="index" separator="OR">
			      sys_post.post_code = '${postCode}'
			    </foreach>
	  	    ) 
	  union all 
	  select sys_user.user_id as id, sys_user.user_disp as name, sys_user_post.post_id as pid, sys_user.user_name as code, 
	         'user' as nodeType,sys_user.user_id as nodePath,20 as levelCode
	  from sys_user,sys_user_post
	  where user_delflag = 0 and sys_user.user_id = sys_user_post.user_id
	        and sys_user_post.post_id in (
	  		  select sys_post.post_id 
			  from sys_post,sys_unit
			  where sys_post.post_delflag = 0 and sys_post.post_unit=sys_unit.unit_id
			  	and 
			  	    (
			  	    	<foreach collection="postCodes" item="postCode" index="index" separator="OR">
					      sys_post.post_code = '${postCode}'
					    </foreach>
			  	    )
	  )
  </select>
  
  <!-- 通过某几个组织机构id获取这几个组织机构的全部其他信息 -->
  <select id="getUnitInfoByUnitIds" parameterType="java.util.Map" resultType="com.pcitc.base.common.TreeNode">
	  select sys_unit.unit_id as id, sys_unit.unit_name as name,sys_unit.unit_relation as pid,sys_unit.unit_code as code, 
	         'unit' as nodeType,sys_unit.unit_path as nodePath, sys_unit.unit_level as levelCode
	  from sys_unit
	  where sys_unit.unit_delflag = 0
	  	and 
	  	    (
	  	    	<foreach collection="unitIds" item="unitId" index="index" separator="OR">
			      sys_unit.unit_path = '${unitId}'
			    </foreach>
	  	    ) 
  </select>
  
  <!-- 组织机构树所有节点, 有组织机构和人员, 没有岗位 -->
  <select id="getUnitTreeAndUserCond" parameterType="com.pcitc.base.system.SysUnit" resultType="com.pcitc.base.common.TreeNode">
	  select u.unit_id as id, u.unit_name as name,u.unit_relation as pid,u.unit_code as code, 'unit' as nodeType,
	         u.unit_level as levelCode,'/layuiadmin/layui/images/operation_19.png' as icon
	  from sys_unit u 
	  where unit_delflag = 0 
	  <if test="unitCode != null and unitCode !=''.toString">
	   and unit_code like '${unitCode}%'
	  </if>
	  union all 
	  select sys_user.user_id as id, sys_user.user_disp as name, sys_user_unit.unit_id as pid, sys_user.user_name as code, 
	         'user' as nodeType,20 as levelCode,'/layuiadmin/layui/images/operation_19.png' as icon
	  from sys_user,sys_user_unit 
	  where user_delflag = 0 and sys_user.user_id=sys_user_unit.user_id 
	        and sys_user_unit.unit_id in (
	  		  select t.unit_id
			  from sys_unit t 
			  where unit_delflag = 0 
			  <if test="unitCode != null and unitCode !=''.toString">
			   and t.unit_code like '${unitCode}%'
			  </if>
	        )
  </select>
  
  <!-- 组织机构树所有节点, 有组织机构和人员、岗位 -->
  <select id="getUnitTreeAndPostAndUserCond" parameterType="com.pcitc.base.system.SysUnit" resultType="com.pcitc.base.common.TreeNode">
	  select u.unit_id as id, u.unit_name as name,u.unit_relation as pid,u.unit_code as code, u.unit_level as levelCode, 'unit' as nodeType
	  from sys_unit u 
	  where unit_delflag = 0 
	  <if test="unitPath != null and unitPath !=''.toString">
	   and unit_path like '${unitPath}%'
	  </if>
	  union all 
	  select sys_user.user_id as id, sys_user.user_disp as name, sys_user_unit.unit_id as pid, sys_user.user_name as code, 100, 'user' as nodeType
	  from sys_user,sys_user_unit 
	  where user_delflag = 0 and sys_user.user_id=sys_user_unit.user_id 
	        and sys_user_unit.unit_id in (
	  		  select t.unit_id
			  from sys_unit t 
			  where t.unit_delflag = 0 
			  <if test="unitPath != null and unitPath !=''.toString">
			   and t.unit_path like '${unitPath}%'
			  </if>
	  )
	  union all 
	  select post_id as id, post_name as name, post_unit as pid, post_code as code, sys_post.post_level as nodeLevel, 'post' as nodeType
	  from sys_post 
	  where post_delflag = 0 and post_unit in (
	  		  select t.unit_id
			  from sys_unit t 
			  where unit_delflag = 0 
			  <if test="unitPath != null and unitPath !=''.toString">
			   and unit_path like '${unitPath}%'
			  </if>
	  )
  </select>
  
  <!-- 查询监理单位 -->
  <select id="selectControlUnit" resultMap="BaseResultMap">
  select unit_name,unit_code 
  from sys_unit 
  where unit_kind= #{unitKind}
  <if test="unitName != null and unitName != ''.toString()">
  and unit_name like '%${unitName}%'
  </if>
  </select>
</mapper>