<#include "/common/public/publicImportIndex.html"/>
<div class="container">
    <div class="row">
        <section>
            <form id="defaultForm" class="form-horizontal">
                <div class="form-group">
                    <div class="col-sm-4">
                        <input type="hidden" class="form-control" name="fileId" id="fileId" placeholder="文件ID"/>
                    </div>
                </div>
                <!--<div class="form-group">-->
                <!--<label class="col-sm-3 control-label">用户ID</label>-->
                <!--<div class="col-sm-4">-->
                <!--<input type="text" class="form-control" name="userId" placeholder="用户ID"/>-->
                <!--</div>-->
                <!--</div>-->
                <div class="form-group">
                    <div class="col-sm-4">
                        <input type="hidden" class="form-control" name="stype" placeholder="类型"/>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label"></label>
                    <div class="col-sm-4">
                        <input type="hidden" class="form-control" name="area" id="area"/>
                    </div>
                </div>
                <!--<div class="form-group">-->
                <!--<label class="col-sm-3 control-label">备注</label>-->
                <!--<div class="col-sm-4">-->
                <!--<input type="text" class="form-control" name="ramarks" placeholder="备注"/>-->
                <!--</div>-->
                <!--</div>-->
                <div class="form-group">
                    <label class="col-sm-3 control-label">人员选择</label>
                    <div class="col-sm-4">
                        <input type="text" class="form-control" id="bak1" name="bak1" placeholder="人员选择"  onclick="showdialog();"/>
                    </div>
                </div>
                <!--<div class="form-group">-->
                <!--<label class="col-sm-3 control-label"></label>-->
                <!--<div class="col-sm-4">-->
                <!--<input type="text" class="form-control" name="bak2" placeholder=""/>-->
                <!--</div>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                <!--<label class="col-sm-3 control-label"></label>-->
                <!--<div class="col-sm-4">-->
                <!--<input type="text" class="form-control" name="bak3" placeholder=""/>-->
                <!--</div>-->
                <!--</div>-->
                <!--<div class="form-group">-->
                <!--<label class="col-sm-3 control-label"></label>-->
                <!--<div class="col-sm-4">-->
                <!--<input type="text" class="form-control" name="bak4" placeholder=""/>-->
                <!--</div>-->
                <!--</div>-->
                <div class="form-group">
                    <div class="col-sm-9 col-sm-offset-3">
                        <button type="submit" class="btn btn-primary">提交</button>
                        <button type="button" class="btn btn-default" data-btn-type="cancel" data-dismiss="modal">取消</button>
                    </div>
                </div>
            </form>
        </section>
    </div>
</div>

<script type="text/javascript">
    function showdialog() {
        modals.openWin({
            winId: "setValuOk",
            title: "选择",
            width: '800px',
            height:'600px',
            backdrop: "static",
            url: "/sysfileshare/dialog_user_list"
        });
    }

    var form = null;
    var id = "${id?default(0)}";
    var fieldId = "${fieldId?default(0)}";
    var opt = "${opt?default(0)}";
    $("input[name=fileId]").val(fieldId);
    $("input[name=stype]").val(opt);
    $(function () {
        form = $('#defaultForm').form();
        //初始化校验
        $('#defaultForm').bootstrapValidator({
            message: '请输入有效值',
            container: 'tooltip',
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            submitHandler: function (validator, functionform, submitButton) {
                modals.confirm('确认保存？', function () {
                    var params = form.getFormSimpleData();
                    ajaxPost('/sysfileshare/savesysFileShareFile', params, function (data, status) {
                            modals.info("数据保存成功");
                            //移除弹出框
                            var modalId = "";
                            if ($(".modal").css("display") == "block") {
                                modalId = $(".modal").attr("id")
                            }
                            parent.$('#' + modalId).remove();
                            //刷新列表页面
                            $("#" + index.pageOnlyId)[0].contentWindow.updaTable();
                    });
                });
            }
        });
        form.initComponent();
        if (fieldId != "0") {
            ajaxPostHeader("sysfileshare/list", JSON.stringify({"fileId": fieldId}), function (data, status) {
                console.log(data);
                var ids = "";
                var names = "";
                for (var i = 0; i < data.length; i++) {
                    if (i == 0) {
                        ids = data[i].area;
                        names = data[i].bak1;
                    } else {
                        ids = ids + "|" + data[i].area;
                        names = names + "|" + data[i].bak1;
                    }
                }
                $("input[name=area]").val(ids);
                $("input[name=bak1]").val(names);
            }, "");
        }
    })
    ;

    function resetForm() {
        form.clearForm();
        $("#sysModule-form").data('bootstrapValidator').resetForm();
    }
</script>
