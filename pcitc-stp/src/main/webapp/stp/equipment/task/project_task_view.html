<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
  <!--[if lt IE 9]>
  <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
  <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/common.css">
    <script src="/common/js/jquery-1.11.3.min.js"></script>
  
    <script type="text/javascript" src="/layuiadmin/layui/layui.js"></script>
    <script type="text/javascript" src="/layuiadmin/modules/base.js"></script>
    <style>
        .layui-form-label {
            width: 120px;
        }

        .layui-input-block {
            margin-left: 145px;
        }

        .layui-row {
            margin-bottom: 15px;
        }

        .tableBox table tr td, .formBoxBody table tr td {
            border: 1px solid #e6e6e6;
            height: 24px;
            line-height: 24px;
        }

        .tableBox table tr td input {
            width: 88%;
            box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
            height: 20px;
            padding: 6px 12px;
            font-size: 12px;
            line-height: 1.42857143;
            color: #555;
            background-color: #fff;
            background-image: none;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        #task_assessment_content .layui-input, .layui-select{
            height: 34px !important;
            width: 100% !important;
        }
        .layui-select-title input{width: 100% !important;}
    </style>
</head>
<body>

        
  <div class="formBox">
  <div class="box-body">
  <form class="layui-form" name="form1" id="form1" action="" method="POST" lay-filter="component-form-group layui-container">
  <input  name="id"      id="id"       value="${id}"                    type="hidden" >
  <input  name="equipmentIds"   id="equipmentIds"    value="${sreProjectBasic.equipmentIds}" type="hidden"  >
  <input  name="documentDoc"    id="documentDoc"     value="${documentDoc}"                  type="hidden">
  <input  name="yearFeeStr"     id="yearFeeStr"      value="${sreProjectBasic.yearFeeStr}"   type="hidden">
  <input  name="functionId"     id="functionId"      type="hidden">
  <input  name="userIds"        id="userIds"         type="hidden">
  
        <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">课题名称<span class="must-fill">*</span></label>
                    <div class="layui-input-block">
                        <input class="layui-input" placeholder="--请选择--" name="name" id="name" readonly="readonly" onclick="chooseProject('${topicId}')"   value="${sreProject.name}" autocomplete="off" type="text">
                    </div>
                </div>
                
                
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">项目执行年限<span class="must-fill">*</span></label>
                    <div class="layui-input-block">
                     <div class="layui-input-inline" style="float:left">
                        <input type="text" class="layui-input" name="beginProjectMonth" id="beginProjectMonth" value="${sreProjectTask.beginProjectMonth}" style="width:150px;float:left" placeholder="开始月份">
                        <div class="layui-form-mid" style="width:8px;float:left"> -</div>
                        <input type="text" class="layui-input" id="endProjectMonth" name="endProjectMonth" value="${sreProjectTask.endProjectMonth}" style="width:150px;float:left" placeholder="结束月份">
                    </div>
                    </div>
                </div>
                
                
                
               <div class="layui-form-item layui-form-text" >
		        <label class="layui-form-label">目标和主要任务<span class="must-fill">*</span></label>
		        <div class="layui-input-block">
		          <textarea placeholder="请简述目标和主要任务，原则上不超过500字" name="taskMainTaskContent" id="taskMainTaskContent"    class="layui-textarea">${sreProjectTask.taskMainTaskContent}</textarea>
		        </div>
		      </div>
		      

            </div>
        </div>
        <div class="tableBox">
            <div class="layui-row" id="task_content">
                <div class="tableToolBox">
                    <div class="tableTitle">项目内容和主要图表 </div>
                    <div class="tableBtns">
                        <a class="layui-btn layui-btn-sm fontColor-blue borderColor-blue btn_add btnMyBgImg"
                           data-type="taskAddEvent">新增
                        </a>
                    </div>
                </div>
                <table class="layui-table">
                    <thead>
                    <tr>
                        <td width="4%">编号</td>
                        <td width="20%">单项设备名称</td>
                        <td width="28%">单项设备立项背景</td>
                        <td width="8%">经费（万元）</td>
                        <td width="8%">备注</td>
                        <td width="3%">删除</td>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="layui-row" id="task_assessment_content">
                <div class="tableToolBox">
                    <div class="tableTitle">
                        计划进度和考核目标
                    </div>
                    <div class="tableBtns">
                        <a class="layui-btn layui-btn-sm fontColor-blue borderColor-blue btn_add btnMyBgImg"
                           data-type="assessmentAddEvent">新增
                        </a>
                    </div>
                </div>
                <table class="layui-table">
                    <thead>
                    <tr>
                        <td width="15%">进度安排</td>
                        <td width="15%">考核目标</td>
                        <td width="15%">考核目标</td>
                        <td width="15%">备注</td>
                        <td width="3%">删除</td>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>



           <div class="formBox" id="budget_table">
            <div class="tableToolBox">
                <div class="tableBtns">
                    <div class="tableTitle">应提交验收的内容
                    </div>
                </div>
            </div>
            <div class="box-body" style="padding-left:10px;padding-right:10px">
                  <#list dicList as vo> 
                    <input style="width:250px;margin:5px;float:left;" type="checkbox" name="taskCheckContents"  lay-skin="primary" title="${vo.name}"
                    <#list "${sreProjectTask.taskCheckContents}"?split(",") as itemValue>
                         <#if itemValue == vo.code>checked="checked"  </#if>
                     </#list> value="${vo.code}">
                    </#list>
             </div>
          </div>  
          
          <!-- 
            <div class="layui-row" id="budget_table">
                <div class="tableToolBox">
                    <div class="tableTitle">应提交验收的内容<span class="must-fill">*</span></div>
                </div>
                <div style="padding:10px">
                    <#list dicList as vo> 
                    <input style="width:100px;margin:5px" type="checkbox" name="taskCheckContents"  lay-skin="primary" title="${vo.name}"
                    <#list "${sreProjectTask.taskCheckContents}"?split(",") as itemValue>
                         <#if itemValue == vo.code>checked="checked"  </#if>
                     </#list> value="${vo.code}">
                    </#list>
                </div>
            </div> -->
            
            

            <div class="layui-row" id="budget_tableNew">
                <div class="tableToolBox">
                    <div class="tableTitle">资金概算表</div>
                </div>
                <table class="layui-table">
                    <thead>
                    <tr>
                        <td width="15%">支出类别</td>
                        <td>项目</td>
                        <td>台套</td>
                        <td>预算金额（万元）</td>
                        <td>小计（万元）</td>
                    </tr>
                    </thead>
                    <tbody>
                        <tr class="capital">
                            <td rowspan="13">资本性支出</td>
                            <td>静止设备</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>机械设备</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>仪器</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>自控仪表</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>计算机及外围设备</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>计算机软件</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>备品、配件</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>土建</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>配套工程</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>设计费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>安装费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>

                        <tr class="capital">
                            <td class="layui-hide"></td>
                            <td>其它</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>

                        <tr class="capitalT">
                            <td class="layui-hide"></td>
                            <td>小计</td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>


                        <tr class="cost">
                            <td rowspan="7">费用性支出</td>
                            <td>会议费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="cost">
                            <td class="layui-hide"></td>
                            <td>差旅费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="cost">
                            <td class="layui-hide"></td>
                            <td>试车、试用费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="cost">
                            <td class="layui-hide"></td>
                            <td>外事费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="cost">
                            <td class="layui-hide"></td>
                            <td>外协费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="cost">
                            <td class="layui-hide"></td>
                            <td>其它费</td>
                            <td><input type="number" value="0"></td>
                            <td><input type="number" value="0"></td>
                            <td></td>
                        </tr>
                        <tr class="costT">
                            <td class="layui-hide"></td>
                            <td>小计</td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>合计</td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="layui-row" id="funds_sources_table">
                <div class="tableToolBox">
                    <div class="tableTitle"> 资金来源表</div>
                    <div class="tableBtns">
                        <a class="layui-btn layui-btn-sm fontColor-blue borderColor-blue btn_add btnMyBgImg"
                           data-type="fundsAddEvent">新增
                        </a>
                    </div>
                </div>
                <table class="layui-table">
                    <thead>
                    <tr>
                        <td width="20%">来源</td>
                        <td width="8%">国家拨款(万)</td>
                        <td width="8%">总部拨付(万)</td>
                        <td width="8%">负责单位自筹(万)</td>
                        <td width="8%">其它(万)</td>
                        <td width="8%">合计(万)</td>
                        <td width="8%">删除</td>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            
            <div class="formBox" id="project_funds_table">
            <div class="tableToolBox">
                <div class="tableBtns">
                    <div class="tableTitle">项目资金安排
                    </div>
                </div>
            </div>
            <div class="box-body" style="padding-left:10px;padding-right:10px">
            
             <label class="layui-form-label" style="width: 100%;text-align: left;margin-left: 0;">
                    ${sreProject.leadUnitName?default('')}</label>
                <table class="layui-table">
                    <thead>
                    <tr>
                        <td width="20%">年 度</td>
                        <td width="8%">费用性支出(万元)</td>
                        <td width="8%">资本性支出(万元)</td>
                        <td width="8%">小 计(万元)</td>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <div id="units"></div>
            </div>
            </div>
  
      
      
       <div class="layui-form-item">
	      	 <label class="layui-form-label">附件</label>
	         <div id="file_div" class="layui-input-block"></div>
       </div>
       
        
      
</form>
</div>
</div>

<script>
var param=JSON.parse(window.localStorage.getItem("param"));
var functionId=param.id;
var equipmentIds=$("#equipmentIds").val();
var file_ids = "documentDoc";
//detail:详情，edit：编辑
file_edit_detail = "detail";
//统管理-附件管理-附件配置：页面标识
file_opt_flag = "b3a52bbe7087419c80813d7716f37674";
var equipmentIds=$("#equipmentIds").val();
//牵头单位名称
var leadUnitName="${sreProject.leadUnitName?default('')}";
//牵头单位--表格
var yearFeeStr="${sreProject.yearFeeStr?default('')}";
//参与单位名称
var joinUnitName="${sreProject.joinUnitName?default('')}";
//参与单位名称--表格
var yearFeeStrJoinUnit="${sreProject.yearFeeStrJoinUnit?default('')}";


var yearFeeStr= $("#yearFeeStr").val();
var beginYear= $("#beginYear").val();
var v_date=(new Date()).getTime();
var equipmentIds=$("#equipmentIds").val();
var table,selectRowData;
layui.config({
    //base: 'layuicommon/module/modules/' //静态资源所在路径
}).extend({
    index: 'layui/tableDemo' //主入口模块
}).use(['form','table','laypage','layer','laydate','laytpl','jquery',"publicMethods"], function(){

	  var admin = layui.admin
      element = layui.element
      ,table = layui.table
      ,layer = layui.layer
      ,laydate = layui.laydate
      ,laypage = layui.laypage
      ,$ = layui.jquery
      ,form = layui.form;
	  var publicMethods=layui.publicMethods;
	  
	  form.render();
	  
	  renderTable(equipmentIds);
	  laydate.render({
	      elem: '#LAY-component-form-group-date'
	  });
	 
	//添加到form.render()之后
	 	$("#file_div").load('/common/public/uploadlayuiload.html');
	
	
	 	publicMethods.createTable($("#beginYear").val(),$("#endYear").val(),"yearTr",2,yearFeeStr,true);
	 	
	 	





	        
	        
	        
      //关闭事件
      $("#closeBtn1").click(function () {
          var index = parent.layer.getFrameIndex(window.name);
          parent.layer.close(index);
      })
});





function renderTable(equipmentIds)
{
	  $("#equipmentIds").val(equipmentIds);
	  table.render({
          elem: '#join_apply_table',
          url: '/sre-equipment/chooseEquipmentByIds?equipmentIds='+equipmentIds,
        //  limit: 15,
          method:"GET",
      	  id: 'join_apply_table',
        //  height: 200,
          //page: {first: '首页',last: '尾页',theme: '#0F9EE0'},
          cols: [[
          	 {title:'序号', type:'numbers'},
            {field : 'name',     title : '装备名称', style : 'cursor: pointer;', align : 'center', width : '20%'},
            {field : 'type',     title : '装备分类', style : 'cursor: pointer;', align : 'center', width : '10%'},
            {field : 'unitPrice', title : '单价（万元）', style : 'cursor: pointer;', align : 'center', width : '10%'},
            {field : 'applyAcount', title : '申请数量', style : 'cursor: pointer;', align : 'center', width : '10%'},
            {field : 'allPrice', title : '总价¥（万元）', style : 'cursor: pointer;', align : 'center', width : '10%',templet:function(d){return '<span style="color:red">'+d.allPrice+'</span>'}},
            {field : 'applyDepartName', title : '申报部门', style : 'cursor: pointer;', align : 'center', width : '10%'},
            {field : 'firstApplyUser', title : '第一申报人', style : 'cursor: pointer;', align : 'center', width : '10%'}
             
          ]]
      });
}


</script>
</body>
</html>