<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" href="/layuiadmin/ztree/css/metroStyle/metroStyle.css">
    <link rel="stylesheet" href="/layuiadmin/style/common.css">

    <script src="/layuiadmin/layui/layui.js"></script>
    <style type="text/css">
        .box-body{margin-bottom: 50px !important;padding: 0 30px;}
    </style>
</head>
<body>
<div class="formBox">
    <form class="layui-form" name="form1" id="form1" action="" method="POST"
          lay-filter="component-form-group layui-container">
        <div class="box-body">
            <input type="hidden" name="equipmentId" id="equipmentId" value="${sreEquipment.equipmentId}">
            <input type="hidden" name="functionId" id="functionId" value="">
            <input type="hidden" name="applyDepartCode" id="applyDepartCode" value="${applyDepartCode}">
            <input type="hidden" name="auditStatus" id="auditStatus" value="">
            <input type="hidden" name="attachmentDoc" id="attachmentDoc" value="${attachmentDoc}">
            <input type="hidden" name="companyCode" id="companyCode" value="">
            <!-- 推荐供应商 -->
            <input type="hidden" name="supplierStr" id="supplierStr" value="${sreEquipment.supplierStr}">
            <!-- 意向供应商-->
            <input type="hidden" name="supplierWillStr" id="supplierWillStr" value="${sreEquipment.supplierWillStr}">

            <!-- 行有两个的情况 -->
            <div class="layui-row">
                <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">装备名称<span class="must-fill">*</span></label>
                        <div class="layui-input-block">
                            <input class="layui-input" name="name" id="name" value="${sreEquipment.name}" lay-verify="name"
                                   placeholder="请输入装备名称" autocomplete="off" type="text">
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">装备分类<span class="must-fill">*</span></label>
                        <div class="layui-input-block">
                            <select name="type" id="ROOT_ZBGL_ZBFL" lay-verify="required" lay-filter="type">
                                <option value="" selected="selected">请选择</option>
                            </select>

                        </div>
                    </div>
                </div>
            </div>


            <div class="layui-row">
                <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">申报单价（万元）<span class="must-fill">*</span></label>
                        <div class="layui-input-block">
                            <input class="layui-input" placeholder="￥" name="unitPrice" id="unitPrice"
                                   value="${sreEquipment.unitPrice}" lay-verify="required" autocomplete="off" type="text"
                                   onkeyup="this.value=this.value.replace(/\D/g,'')"
                                   onafterpaste="this.value=this.value.replace(/\D/g,'')">
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">申请数量<span class="must-fill">*</span></label>
                        <div class="layui-input-block">
                            <input class="layui-input" name="applyAcount" id="applyAcount"
                                   value="${sreEquipment.applyAcount}" lay-verify="required" autocomplete="off" type="text"
                                   onkeyup="this.value=this.value.replace(/\D/g,'')"
                                   onafterpaste="this.value=this.value.replace(/\D/g,'')">
                        </div>
                    </div>
                </div>
            </div>


            <div class="layui-form-item layui-form-text">
                <label for="" class="layui-form-label">规格型号、参数<span class="must-fill">*</span></label>
                <div class="layui-input-block">
                <textarea placeholder="请输入规格型号、参数" name="specification" id="specification" lay-verify="required"
                          class="layui-textarea">${sreEquipment.specification}</textarea>
                </div>
            </div>

            <!-- 文本域 -->
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">主要功能与用途<span class="must-fill">*</span></label>
                <div class="layui-input-block">
                <textarea placeholder="请输入内容" name="specialNotes" id="specialNotes" lay-verify="required"
                          class="layui-textarea">${sreEquipment.specialNotes}</textarea>
                </div>
            </div>

            <!-- <div class="layui-form-item">
                     <label class="layui-form-label">推荐供应商</label>
                     <div class="layui-input-block">
                         <div class="tableBox">
                             <div class="tableToolBox">
                                 <div class="whiteLine"></div>
                                 <div class="tableBtns">
                                     <a href="javascript:void(0)" onclick="chooseBusiness_data()"
                                        class="layui-btn layui-btn-sm fontColor-blue borderColor-blue btn_add btnMyBgImg"
                                        data-type="selectEvent">选择</a>
                                 </div>
                             </div>
                             <table id="join_apply_table" class="layui-hide" lay-filter="JoinEvent"></table>
                         </div>
                     </div>
                 </div> -->


            <div class="layui-form-item">
                <label class="layui-form-label">推荐供应商</label>
                <div class="layui-input-block">
                    <div class="tableBox" id="supplier_str">
                        <div class="tableToolBox">
                            <div class="tableBtns">
                                <a class="layui-btn layui-btn-sm fontColor-blue borderColor-blue btn_add btnMyBgImg"
                                   onclick="chooseBusiness_data()">添加</a>
                            </div>
                        </div>
                        <table class="layui-table">
                            <thead>
                            <tr>
                                <td width="12%">供应商ID</td>
                                <td width="14%">供应商名称</td>
                                <td width="12%">所在城市</td>
                                <td width="12%">所属单位</td>
                                <td width="12%">电话</td>
                                <td width="12%">传真</td>
                                <td width="12%">地址</td>
                                <td width="8%">删除</td>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>

                    </div>
                </div>
            </div>


            <div class="layui-form-item">
                <label class="layui-form-label">意向供应商</label>
                <div class="layui-input-block">
                    <div class="tableBox" id="supplier_will_str">
                        <div class="tableToolBox">
                            <div class="tableBtns">
                                <a class="layui-btn layui-btn-sm fontColor-blue borderColor-blue btn_add btnMyBgImg"
                                   id="gysAddEvent">添加</a>
                            </div>
                        </div>
                        <table class="layui-table">
                            <thead>
                            <tr>
                                <td width="12%">供应商名称</td>
                                <td width="12%">所在城市</td>
                                <td width="12%">所属单位</td>
                                <td width="12%">电话</td>
                                <td width="12%">传真</td>
                                <td width="12%">地址</td>
                                <td width="8%">删除</td>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>

                    </div>
                </div>
            </div>


            <div class="layui-row">
                <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">申报单位<span class="must-fill">*</span></label>
                        <div class="layui-input-block">
                            <input class="layui-input" name="applyDepartName" readonly="readonly" id="applyDepartName"
                                   value="${applyDepartName}" lay-verify="required" autocomplete="off" type="text">
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label for="" class="layui-form-label">第一申报人<span class="must-fill">*</span></label>
                        <div class="layui-input-block">
                            <input class="layui-input" name="firstApplyUser" id="firstApplyUser" readonly="readonly"
                                   value="${firstApplyUser}" lay-verify="required" autocomplete="off" type="text">
                        </div>
                    </div>
                </div>
            </div>


            <!-- 文本域 -->
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">备注</label>
                <div class="layui-input-block">
                <textarea placeholder="请输入备注" name="notes" id="notes"
                          class="layui-textarea">${sreEquipment.notes}</textarea>
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">附件</label>
                <div id="file_div" class="layui-input-block"></div>
            </div>

        </div>

        <div class="form-bottom" style="margin-top: 15px;">
            <div class="form-bottom-btns">
                <button class="layui-btn layui-btn-sm fontColor-white btnMyBgImg layui-btn-mini layui-btn-blue"
                        lay-submit="sub" lay-filter="sub">保存
                </button>
                <button type="button"
                        class="layui-btn layui-btn-sm fontColor-default border-default btnMyBgImg layui-btn-mini layui-btn-white"
                        id="closeBtn">关闭
                </button>
            </div>
        </div>
    </form>
</div>
<script src="/common/js/jquery-1.11.3.min.js"></script>
<script>
    var v_date = (new Date()).getTime();
    var table, form;
    var file_ids = "attachmentDoc";
    //detail:详情，edit：编辑
    file_edit_detail = "edit";
    //统管理-附件管理-附件配置：页面标识
    file_opt_flag = "546f1237f09d4aa19e91721180253b48";
    var publicMethods;
    var param = JSON.parse(window.localStorage.getItem("param"));
    var functionId = param.id;
    $('#functionId').val(functionId);
    var roleCodes = "";
    var unitCodes = "";
    var postCodes = "";

    layui.use(['jquery', 'form', 'laypage', 'laydate', 'table', 'layer', "publicMethods"], function () {
        var $ = layui.jquery,
            admin = layui.admin
            , element = layui.element
            , layer = layui.layer
            , laydate = layui.laydate;
        form = layui.form;
        table = layui.table;
        publicMethods = layui.publicMethods;
        var equipmentId = "${equipmentId?default(0)}";
        var type = "${sreEquipment.type?default('')}";


        /*初始化推荐供应商*/
        var supplierStr = $("#supplierStr").val();
        if (supplierStr != '') {
            $.each(supplierStr.split("|"), function (i, val) {
                var taskVal = val.split("#");
                var tr = "<tr><td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[0] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[1] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[2] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[3] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[4] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[5] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 75%;'>" + taskVal[6] + "</textarea></td>" +
                    "<td><a href='javascript:;' class='dele'>删除</a></td></tr>";
                addTr("supplier_str", tr);
                formVerify();
            });
        }


        /*初始化意向供应商*/
        //var taskArr = "1#2#3#4#5|2#9#8#7#6";
        var taskArr = $("#supplierWillStr").val();
        if (taskArr != '') {
            $.each(taskArr.split("|"), function (i, val) {
                var taskVal = val.split("#");
                var tr = "<tr><td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[0] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[1] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[2] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[3] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[4] + "</textarea></td>" +
                    "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[5] + "</textarea></td>" +
                    "<td><a href='javascript:;' class='dele'>删除</a></td></tr>";
                addTr("supplier_will_str", tr);
                formVerify();
            });
        }
        dele();
        //意向供应商事件
        $("#gysAddEvent").click(function () {
            var n = $("#supplier_will_str table tbody tr").length + 1;
            var tr = "<tr><td><textarea     rows='2' style='width: 95%;'></textarea></td><td><textarea     rows='2' style='width: 95%;'></textarea> </td>" +
                "<td><textarea     rows='2' cols='20' style='width: 95%;'></textarea> </td><td><textarea     rows='2' style='width: 95%;'></textarea> </td>" +
                "<td><textarea     rows='2' style='width: 95%;'></textarea> </td>" +
                "<td><textarea     rows='2' style='width: 95%;'></textarea> </td>" +
                "<td><a href='javascript:;' class='dele'>删除</a></td></tr>";
            addTr("supplier_will_str", tr);
            dele();
            formVerify();
        })


        var $ = layui.$, active = {
            gysAddEvent: function () {
            }
        };

        //alert(type);
        //加载字典
        var dicMap = ['ROOT_ZBGL_ZBFL'];
        publicMethods.ajaxPost("/dictionary/map/getMapListDictionarys", {"parentCodes": JSON.stringify(dicMap)}, function (data) {
            $.each(data, function (key, val) {
                $.each(val, function (i, dt) {
                    var content = '<option value="' + dt.code + '"';
                    if (dt.code == type) {
                        content += ' selected="selected" ';
                    }
                    content += ' >' + dt.name + '</option>';
                    $("#" + key).append(content);
                    //$("#"+key).append('<option value="'+dt.code+'">'+dt.name+'</option>');
                });
            });
        });

        form.render();
        //添加到form.render()之后
        $("#file_div").load('/common/public/uploadlayuiload.html');

        /* 自定义验证规则  title 要验证的input的 lay-verify=""*/
        form.verify({
            name: function (value) {
                if (value.length < 5) {
                    return '装备名称至少得5个字符啊';
                }
            }
        });


        //开始日期
        var insStart = laydate.render({
            elem: '#beginYear'
            , min: 0, type: 'year'
            , done: function (value, date) {
                //更新结束日期的最小日期
                insEnd.config.min = lay.extend({}, date, {
                    month: date.month - 1
                });
                //自动弹出结束日期的选择器
                insEnd.config.elem[0].focus();
            }
        });

        //结束日期
        var insEnd = laydate.render({
            elem: '#endYear'
            , min: 0, type: 'year'
            , done: function (value, date) {
                //更新开始日期的最大日期
                insStart.config.max = lay.extend({}, date, {
                    month: date.month - 1
                });
            }
        });


        /* 监听提交 */
        form.on('submit(sub)', function (data) {

            var url = "/sre-equipment/save?v_date=" + v_date;
            var backurl = "/sre-equipment/to-list?v_date=" + v_date;

            var supplierStr = getData("supplier_str", 7);
            $("#supplierStr").val(supplierStr);

            var supplierWillStr = getData("supplier_will_str", 6);
            $("#supplierWillStr").val(supplierWillStr);


            ajaxOpt(url, "form1", "POST", backurl, "保存成功", "保存失败");
            return false;
        });
        //关闭事件
        $("#closeBtn").click(function () {
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
        })
        //流程
        form.on('submit(flow)', function (data) {
            $.ajax({
                type: 'POST',
                url: "/workflow/start/audit-type",
                contentType: "application/json;charset=UTF-8",
                data: JSON.stringify(data.field),
                //json中有functionId（projectId、departmentId等）用来区别processDefine的属性
                success: function (data) {
                    if (data.code == 'role') {
                        // 按角色选择，获取下一步审批人信息,选择完审批人后，调用：handleTask(userIds)方法
                        // roleCodes，参数名必须一致，方便公共弹出页面调用
                        roleCodes = data.data;  // 弹出页面的隐藏的查询条件
                        var temUrl = "/task/deal/users/ini";
                        layer.open({
                            title: '选择审批人',
                            skin: 'layui-layer-lan',
                            shadeClose: true,
                            type: 2,
                            fixed: false,
                            //若使用小窗口形式，则修改 maxmin 值为 true，则注释掉area:[100%,100%]属性,同时设置area: ['900px', '450px']
                            maxmin: true,
                            //若直接弹出页面 ，则修改 area;[100%,100%]，同时设置 maxmin 为false
                            area: ['800px', '550px'],
                            content: temUrl
                        });
                    } else if (data.code == 'unit' || data.code == 'post') {
                        // 按部门/岗位选择，获取下一步审批人信息,选择完审批人后，调用：handleTask(userIds)方法
                        // unitCodes、postCodes，参数名必须一致，方便公共弹出页面调用
                        if (data.code == 'unit') {
                            unitCodes = data.data;  // 弹出页面的隐藏的查询条件
                        } else {
                            postCodes = data.data;  // 弹出页面的隐藏的查询条件
                        }

                        var temUrl = "/task/deal/user/unit/ini";
                        layer.open({
                            title: '选择审批人',
                            skin: 'layui-layer-lan',
                            shadeClose: true,
                            type: 2,
                            fixed: false,
                            //若使用小窗口形式，则修改 maxmin 值为 true，则注释掉area:[100%,100%]属性,同时设置area: ['900px', '450px']
                            maxmin: true,
                            //若直接弹出页面 ，则修改 area;[100%,100%]，同时设置 maxmin 为false
                            area: ['800px', '550px'],
                            content: temUrl
                        });
                    } else if (data.code == 'int') {
                        layer.msg('启动参数不足');
                    } else if (data.code == 'con') {
                        layer.msg('请给此功能菜单配置流程');
                    } else if (data.code == 'exist') {
                        layer.msg('工作流部署异常，请联系管理员');
                    } else {
                        // 直接处理此任务
                        handleTask('');
                    }
                },
                error: function (msg) {//请求失败处理函数
                }
            });

            return false;
        });


    });

    function chooseBusiness_data() {
        var dataId = checkSysUserProperty();
        if (dataId == '') {
            layer.alert("请先到“系统管理”中配置直属研究院数据");
            return;
        }
        var v_date = (new Date()).getTime();
        var temUrl = "/sre-equipment/to-choose-chooseBusiness?v_date=" + v_date + "&companyCode=" + dataId;
        layer.open({
            title: '选择供应商',
            skin: 'layui-layer-lan',
            shadeClose: true,
            type: 2,
            fixed: false,
            maxmin: true,
            area: ['90%', '90%'],
            content: temUrl
        });
    }


    function checkSysUserProperty() {
        var dataId = "";
        var v_date = (new Date()).getTime();
        var temUrl = "/sre-equipment/checkSysUserProperty?v_date=" + v_date;
        $.ajax({
            type: 'GET',
            url: temUrl,
            dataType: "json",
            async: false,
            cache: false,
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            success: function (data, status) {

                if (data.success == true || data.success == 'true') {

                    dataId = data.data.dataId;
                    $("#companyCode").val(dataId);

                }

            }

        });
        return dataId;
    }


    function ajaxOpt(url, formName, type, backurl, successMsg, failMsg) {

        $.ajax({
            type: type,
            url: url,
            dataType: "json",
            data: $("#" + formName).serialize(),
            async: false,
            cache: false,
            contentType: "application/x-www-form-urlencoded; charset=utf-8",
            success: function (data, status) {

                if (data.success == true || data.success == 'true') {


                    layer.alert(
                        successMsg,
                        {icon: 1, closeBtn: 0},
                        function () {
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
                            parent.location.href = backurl;
                        });

                } else {
                    layer.alert(failMsg);
                }

            },
            error: function () {
                layer.alert("网络访问错误");
            }

        });
    }

    //处理任务（启动流程）的方法，方法名固定，为了通用选择审批人员的弹出页面调用
    function handleTask(userIds) {
        $('#userIds').val(userIds);
        $('#auditStatus').val(1);
        //alert("userIds="+userIds+" functionId="+functionId+" auditStatus="+auditStatus);
        var url = "/sre-equipment/save?v_date=" + v_date;
        var backurl = "/sre-equipment/to-list?v_date=" + v_date;
        ajaxOpt(url, "form1", "POST", backurl, "保存成功", "保存失败");
    }


    function setSupplierStr(supplierStr) {
        $("#supplier_str table tbody").empty();
        var taskArr = $("#supplierStr").val();
        if (taskArr != '') {
            $.each(taskArr.split("|"), function (i, val) {
                if (val != '') {
                    var taskVal = val.split("#");
                    var tr = "<tr><td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[0] + "</textarea></td>" +
                        "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[1] + "</textarea></td>" +
                        "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[2] + "</textarea></td>" +
                        "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[3] + "</textarea></td>" +
                        "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[4] + "</textarea></td>" +
                        "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[5] + "</textarea></td>" +
                        "<td><textarea    rows='2' cols='20' style='width: 95%;'>" + taskVal[6] + "</textarea></td>" +
                        "<td><a href='javascript:;' class='dele'>删除</a></td></tr>";
                    addTr("supplier_str", tr);
                    formVerify();
                }

            });
        }

        dele();
    }

    function renderTable(supplierIds) {
        var companyCode = $("#companyCode").val();
        table.render({
            elem: '#join_apply_table',
            url: '/sre_supplier/getHanaSupplierByIds?supplierIds=' + supplierIds + "&companyCode=" + companyCode,
            limit: 15,
            method: "GET",
            id: 'join_apply_table',
            height: 300,
            cols: [[

                {title: '序号', type: 'numbers'},
                {field: 'supplierCode', title: '供应商ID', style: 'cursor: pointer;', align: 'left', width: '10%'},
                {field: 'supplierName', title: '供应商名称', style: 'cursor: pointer;', align: 'left', width: '20%'},
                {field: 'cityName', title: '所在城市', style: 'cursor: pointer;', align: 'center', width: '10%'},
                {field: 'unitName', title: '所属单位', style: 'cursor: pointer;', align: 'center', width: '10%'},
                {field: 'mobile', title: '电话', style: 'cursor: pointer;', align: 'center', width: '10%'},
                {field: 'fix', title: '传真', style: 'cursor: pointer;', align: 'center', width: '10%'},
                {field: 'address', title: '地址', style: 'cursor: pointer;', align: 'center', width: '20%'}
            ]],
            done: function (res, curr, count) {

            }
        });
    }


    /*添加行*/
    function addTr(id, tr) {
        $("#" + id + " table tbody").append(tr);
    }

    /*获取值*/
    function getData(id, number) {
        /*获取值*/
        var columnTrL = $("#" + id + " table tbody tr").length;
        var columnSC = '';
        $("#" + id + " table tbody tr").each(function (i) {
            var columnS = '';
            for (var k = 0; k < number; k++) {
                var tdElement = $("#" + id + " table tbody tr:eq(" + i + ") td").eq(k);
                if ($(tdElement).find("input").length > 0) {
                    if ($(tdElement).find("input").val() == '') {
                        columnS += " " + "#";
                    } else {
                        columnS += $(tdElement).find("input").val() + "#";
                    }
                } else if ($(tdElement).find("textarea").length > 0) {
                    if ($(tdElement).find("textarea").val() == '') {
                        columnS += " " + "#";
                    } else {
                        columnS += $(tdElement).find("textarea").val() + "#";
                    }
                } else {
                    columnS += $(tdElement).html() + "#";
                }
            }
            columnSC += columnS.substring(0, columnS.length - 1) + "|"
        });
        columnSC = columnSC.substring(0, columnSC.length - 1);
        return columnSC;
    }

    /*删除行*/
    function dele() {
        $(".dele").click(function () {
            if ($(this).parents(".layui-row").attr("id") == "supplier_will_str") {
                $(this).parents("tr").remove();
                $("#supplier_will_str table tbody tr").each(function (i, val) {
                    $(val).find("td:first").text(i + 1)
                });
                return;
            }
            $(this).parents("tr").remove();
        });
    }

    /*select*/
    function selectHtml(arr, value, id) {
        if (value == "") {
            $.each(arr, function (i, val) {
                id.append("<option value='" + val + "'>" + val + "</option>");
            });
        } else {
            $.each(arr, function (i, val) {
                if (value == val) {
                    id.append("<option value='" + val + "'  selected = 'selected' >" + val + "</option>");
                } else {
                    id.append("<option value='" + val + "'>" + val + "</option>");
                }
            });
        }

    }

    function formVerify() {
        form.verify({
            validateNumber: function (value, item) {
                if (value <= 0 || value > 2000) {
                    return '请填写正确的值';
                }
            },
            specialCharacters: function (value, item) {

                if (value.indexOf("#") >= 0 || value.indexOf("|") >= 0) {
                    return "不能填写#与|两个字符。";
                }
            }
        });
    }

    function clearNoNum(obj) {
        obj.value = obj.value.replace(/[^\d.]/g, "");  //清除“数字”和“.”以外的字符
        obj.value = obj.value.replace(/\.{2,}/g, "."); //只保留第一个. 清除多余的
        obj.value = obj.value.replace(".", "$#$").replace(/\./g, "").replace("$#$", ".");
        obj.value = obj.value.replace(/^(\-)*(\d+)\.(\d\d).*$/, '$1$2.$3');//只能输入两个小数
        if (obj.value.indexOf(".") < 0 && obj.value != "") {//以上已经过滤，此处控制的是如果没有小数点，首位不能为类似于 01、02的金额
            obj.value = parseFloat(obj.value);
        }
    }
</script>
</body>
</html>