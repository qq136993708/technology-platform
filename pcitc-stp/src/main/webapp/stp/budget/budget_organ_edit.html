<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>新增/编辑</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">
<link rel="stylesheet" type="text/css" href="/layuiadmin/layui/css/layui.css">
<link rel="stylesheet" type="text/css" href="/layuiadmin/style/common.css">

<script type="text/javascript" src="/layuiadmin/javascript/ckeditor5/ckeditor.js"></script>
<script type="text/javascript" src="/plugins/jQuery/jQuery-2.2.0.min.js"></script>
<script type="text/javascript" src="/layuiadmin/layui/layui.js"></script>


<script type="text/javascript">
$(document).ready(function() {
	layui.use([ 'jquery', 'form', 'laydate', 'table', 'layer', 'element',"publicMethods" ],function() {
		var $ = layui.jquery, admin = layui.admin, element = layui.element, layer = layui.layer, laydate = layui.laydate;
		var form = layui.form;
		var dataId = "${dataId?default(0)}";
		var publicMethods=layui.publicMethods;
		var dataorganmap = [];
		form.on('select(organDataId)', function(data){
 			publicMethods.ajaxAsyncPost('/budget/budget-organitems-get', {"dataId":$("#organDataId").val()}, function (dt, status) {
 				form.val("organitem-form",dt);
            });
 		});

	 	publicMethods.ajaxAsyncPost('/budget/budget-organitems-list',null,function(data,status){
	 		$.each(data,function(i,d){
				$("#organDataId").append('<option value="'+d.dataId+'">'+d.organName+'</option>');
				dataorganmap[d.organId]=d.dataId;
			});
	 		if(dataId != 0)
	        {
		 		publicMethods.ajaxPost('/budget/budget-organ-get', {"dataId":dataId}, function (dt, status) {
	        		$("#organDataId").val(dataorganmap[dt.organId]);
	        		form.val("organitem-form",dt);
	            });
	        }
	 		form.render();
	 	});
		/* 监听提交 */
		form.on('submit(submitBtn)', function(data) {
			publicMethods.ajaxPost('/budget/budget-organ-saveorupd', data.field, function (data, status) {
                      if (data.success) {
                      	parent.renderTable();
                      	var index = parent.layer.getFrameIndex(window.name);
			       	parent.layer.close(index);
                      }else{
                      	parent.layer.alert(data.message, {
						title : '信息'
					});
					return false;
                      }
                  });
			return false;
		});
	});
	$("#cancel").click(function () {
	    var index = parent.layer.getFrameIndex(window.name);
	    parent.layer.close(index);
	})
});
</script>
</head>
<body>
<div class="formBox">
	<form id="organitem-form" name="organitem-form" lay-filter="organitem-form" class="form-horizontal layui-form">
	<input type="hidden" name="dataId" id="dataId">
	<div class="box-body">
		<div class="layui-row">
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">序号<span class="must-fill">*</span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input" lay-verify="required" id="no" name="no" placeholder="序号">
					</div>
				</div>
			</div>
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">选择预算项<span class="must-fill">*</span></label>
					<div class="layui-input-block">
                        <select name="organDataId" id="organDataId" lay-verify="required"  lay-filter="organDataId">
                            <option value="">--请选择预算项--</option>
                        </select>
                    </div>
				</div>
			</div>
		</div>
		<div class="layui-row">
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">预算项ID<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox"  readonly="readonly" lay-verify="required" id="organId" name="organId" placeholder="预算项ID">
					</div>
				</div>
			</div>
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">预算单位名称<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox"  readonly="readonly" lay-verify="required" id="organName" name="organName" placeholder="预算单位名称">
					</div>
				</div>
			</div>
		</div>
		<div class="layui-row">
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">预算项编码<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox" readonly="readonly" id="organCode" name="organCode" placeholder="预算项编码">
					</div>
				</div>
			</div>
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">单位编码<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox" readonly="readonly" id="unitCode" name="unitCode" placeholder="单位编码">
					</div>
				</div>
			</div>
			
		</div>
		<div class="layui-row">
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">联系人<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox"  readonly="readonly"  id="contactsName" name="contactsName" placeholder="联系人">
					</div>
				</div>
			</div>
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">邮箱<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox" readonly="readonly" id="contactsEmail" name="contactsEmail" placeholder="邮箱">
					</div>
				</div>
			</div>
		</div>
		<div class="layui-row">
			<div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
				<div class="layui-form-item">
					<label for="" class="layui-form-label">联系人电话<span class="must-fill"></span></label>
					<div class="layui-input-block">
						<input type="text" class="layui-input readOnlyBox" readonly="readonly" id="contactsPhone" name="contactsPhone" placeholder="联系电话">
					</div>
				</div>
			</div>
		
		</div>
		<div class="layui-form-item">
	      	 <label class="layui-form-label">备注<span class="must-fill"></span></label>
	         <div class="layui-input-block">
	         	   <textarea class="layui-textarea readOnlyBox" id="remark" readonly="readonly" name="remark" placeholder="备注"></textarea>
	         </div>
       </div>
      
	</div>
	<div class="form-bottom">
      <div class="form-bottom-btns">
      	<button class="layui-btn layui-btn-sm fontColor-white btnMyBgImg layui-btn-mini layui-btn-blue" lay-submit="" lay-filter="submitBtn">保存</button>
      	<!-- <button type="reset" class="layui-btn layui-btn-sm fontColor-default border-default btnMyBgImg layui-btn-mini layui-btn-white">重置</button> -->
      	<button type="button" class="layui-btn layui-btn-sm fontColor-default border-default btnMyBgImg layui-btn-mini layui-btn-white"  id="cancel">取消</button>
      </div>
    </div>
</form>
</div>
</body>
</html>