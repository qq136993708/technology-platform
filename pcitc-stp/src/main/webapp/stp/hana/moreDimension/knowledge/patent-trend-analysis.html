<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
<link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/common.css">
    
    
      <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/adminStp.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/mainStp.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/common.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/second.css" media="all">
    
    
</head>
<body>
	<div class="layui-fluid">
	<input type="hidden" name="year"  value="${year}"   id="year">
		<div class="layui-main-oil">
			<div class="searchBox">
				<!--查询条件-->
				<label class="dateInput"> <span>月份</span> <input type="text"
					name="month" placeholder="请选择月份" title="月份" value="${month}"
					autocomplete="off" class="form-control" id="month">
				</label>
				<div class="layui-input-inline">
              <select id="companyCode" name="companyCode" class="form-control" style="width:150px"></select>
             </div>
				<!--按钮组-->
				<div class="btnGroup">
					<button
						class="layui-btn layui-btn-sm fontColor-white btn_search btnMyBgImg"
						onclick="search_Event()" data-type="searchEvent">查询</button>
				</div>
				<span class="unitBox">单位：万元</span>
			</div>
			<div class="layui-row layui-col-space10">
				<div class="layui-col-sm6">
					<div class="layui-card">
						<div class="layui-card-header">
							<span class="layui-time"></span>专利授权数量年趋势分析
						</div>
						<div class="layui-row-main">
							<div class="main-chart" id="chart1" style="height: 280px; width: 100%;"></div>
						</div>
					</div>
				</div>
				<div class="layui-col-sm6">
					<div class="layui-card">
						<div class="layui-card-header">
						<span class="layui-time"></span>年专利申请/授权数量
						</div>
						<div class="layui-row-main" style="height: 280px;">
							   <div class="text-total">
		                            <span>总计:<span class="text-total-blue"    id="knowldege_chart1_01"><img class="loadingImg" src="/layuiadmin/layui/images/loadingImg04.gif" alt=""></span></span>
		                            <span>专利申请:<span class="text-total-blue" id="knowldege_chart1_02"><img class="loadingImg" src="/layuiadmin/layui/images/loadingImg04.gif" alt=""></span></span>
		                            <span>专利授权:<span class="text-total-blue" id="knowldege_chart1_03"><img class="loadingImg" src="/layuiadmin/layui/images/loadingImg04.gif" alt=""></span></span>
		                        </div>
		                        <div class="main-chart" id="knowldege_chart1" style="height:280px;width: 100%;"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="layui-row layui-col-space10">
				<div class="layui-col-sm6">
					<div class="layui-card">
						<div class="layui-card-header">
							<span class="layui-time"></span>专利授权数量按专利类型占比分析
						</div>
						<div class="layui-row-main">
							<div class="main-chart" id="main3"
								style="height: 280px; width: 100%;"></div>
						</div>
					</div>
				</div>
				<div class="layui-col-sm6">
					<div class="layui-card">
						<div class="layui-card-header">
							<span class="layui-time"></span>专利授权数量按研究院占比分析
						</div>
						<div class="layui-row-main">
							<div class="main-chart" id="main4"
								style="height: 280px; width: 100%;"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="layui-row layui-col-space10">
				<div class="layui-col-sm12">
					<div class="layui-card">
						<div class="layui-card-header">
							<span class="layui-time"></span>专利授权数量按研究院同比分析
						</div>
						<div class="layui-row-main">
							<div class="main-chart" id="main5"
								style="height: 280px; width: 100%;"></div>
						</div>
					</div>
				</div>
			</div>
			<!-- <div class="layui-row layui-col-space10">
				<div class="layui-col-sm12">
					<div class="layui-card">
						<div class="layui-card-header">
							<span class="layui-time"></span>人均专利授权数量按研究院分布情况分析
						</div>
						<div class="layui-row-main">
							<div class="main-chart" id="main6"
								style="height: 280px; width: 100%;"></div>
						</div>
					</div>
				</div>
			</div> -->
		</div>
	</div>

	<!--表格数据操作js-->
	<script src="/common/js/jquery-1.11.3.min.js"></script>
	<script type="text/javascript" src="/layuiadmin/layui/layui.js"></script>
	<script src="/common/js/layer-v3.1.1/layer.js"></script>
	<script type="text/javascript" src="/plugins/echarts/echarts.min.js"></script>
	<script type="text/javascript" src="/plugins/echarts/walden.js"></script>
	<script type="text/javascript" src="/stp/hana/common/stp_common_line.js"></script>
	<script type="text/javascript" src="/stp/hana/common/stp_common_bar.js"></script>
	<script type="text/javascript" src="/stp/hana/common/stp_common_pie.js"></script>
	<script type="text/javascript" src="/stp/hana/common/stp_common_mult_bar.js"></script>
	<script src="/stp/hana/common/hana_common.js"></script>
	<script type="text/javascript" src="/stp/hana/home/direct_depart/direct_common.js"></script>
	<script type="text/javascript">
	var param=JSON.parse(window.localStorage.getItem("param"));
	var functionId=param.id;
	
	
		layui.config({
			base : '/layuiadmin/module/modules/'
		}).use(['jquery', 'form', 'laydate', 'table', 'laypage'], function(){
			$ = layui.jquery, table = layui.table, form = layui.form, laydate = layui.laydate
			form.render(null, 'component-form-group');
			laydate.render(
			{
				elem : '#month',
				format : 'yyyyMM'
			});
			var monthValY = $("#month").val().substring(4, 0);
			var monthValM = $("#month").val().substring(4);
			$(".layui-time").html(monthValY + "年" + monthValM + "月");
		});

		function init()
		{
			
			init_companyCode(functionId);
			
			
			var allCode = "${allCode?default('')}";
			var allCode_text = "全部院所";
			var v_date = (new Date()).getTime();
			var month = $('#month').val();
			var companyCode = $('#companyCode').val();
			var monthstr = getNowFormatDate($('#month').val());
			var checkText = $("#companyCode").find("option:selected").text();
			var monthValY = $("#month").val().substring(4, 0);
			var monthValM = $("#month").val().substring(4);
			$(".layui-time").html(monthValY + "年" + monthValM + "月");
			if (checkText == '全部')
			{
				checkText = "全部院所";
			}
			var yAxis = [
			{
				type : 'value',
				name : '金额(万元)',
				min : 0,
				max : 'dataMax',
				position : 'left',
				axisLabel :
				{
					formatter : '{value}'
				}
			}];
			var chart1_url = "/more-dimension/patent_trend_analysis_01?month=" + month + "&v_date=" + v_date + "&companyCode=" + companyCode;
			var echart1 = load_mult_bar(chart1_url, "chart1", "", "", function(data){
				console.log(data);
			});
			/* var chart1_url = "/more-dimension/patent_trend_analysis_01?month=" + month + "&v_date=" + v_date + "&companyCode=" + companyCode;
			var echart1 = load_mutl_bar_2(chart1_url, "chart1", "", "", yAxis);
			echart1.on('click', function(params)
			{
				var xName = params.name;
				var legentName = params.seriesName;
				parent.layui.index.openTabsPage("/home/project-list?define1=" + xName + "&project_scope=" + legentName, "合同签订详情");

			}); */

			var chart2_url = "/more-dimension/patent_trend_analysis_03?month=" + month + "&v_date=" + v_date + "&companyCode=" + companyCode;
			var echart2 = loadPie(chart2_url, "main3", "", '');
			echart2.on('click', function(params)
			{
				var xName = params.name;
				var legentName = params.seriesName;
				parent.layui.index.openTabsPage("/home/project-list?define1=" + xName, "合同签订详情");

			});

			var chart4_url = "/more-dimension/patent_trend_analysis_institute?month=" + month + "&v_date=" + v_date + "&companyCode=" + companyCode;
			var echart4 = loadPie(chart4_url, "main4", "", '');
			echart4.on('click', function(params)
			{
				var xName = params.name;
				var legentName = params.seriesName;
				parent.layui.index.openTabsPage("/home/project-list?define1=" + xName, "合同签订详情");

			});
			
			
			
			//专利申请/授权数量
		    $("#knowldege_chart1_01").html('<img class="loadingImg" src="/layuiadmin/layui/images/loadingImg04.gif" alt="">');
		    $("#knowldege_chart1_02").html('<img class="loadingImg" src="/layuiadmin/layui/images/loadingImg04.gif" alt="">');
		    $("#knowldege_chart1_03").html('<img class="loadingImg" src="/layuiadmin/layui/images/loadingImg04.gif" alt="">');
		    
		    
		    var yAxist= [
		        {
		            type: 'value',
		            name: '数量（个）',
		            position: 'left',
		            axisLabel: {
		                formatter: '{value}'
		            }
		        }
		    ];
		    
		    var v_date=(new Date()).getTime();
			var nd=$('#year').val();
			var chart1_url="/direct/getKnowledgeBar_01?type=1&nd="+nd+"&v_date="+v_date;
			var echart1=load_mutl_bar_down(chart1_url,"knowldege_chart1","","",yAxist,35);
			echart1.on('click', function (params) {
				var xName=params.name;
				var legentName=params.seriesName;
				window.open("/reportNew/reportPageStp?name=1673442773d_74f124ab&jsonparam=g0_type_flag,g0_project_scope");
		          
		    });
			

		}
		
		
		
		
		init();
		function search_Event()
		{
			init();
		}
	</script>
</body>
</html>
