<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
<link rel="stylesheet" href="/layuiadmin/style/adminStp.css" media="all">
<link rel="stylesheet" href="/layuiadmin/style/mainStp.css" media="all">
<link rel="stylesheet" href="/layuiadmin/style/common.css" media="all">
<link rel="stylesheet" href="/layuiadmin/style/second.css" media="all">
    <style>
        html{background-color: #F0F2F5;}
        .layui-fluid{padding: 0 8px;}
        .main-chart{padding: 10px;}
        .searchBox{background: none;}
    </style
</head>
<body >
<div class="layui-fluid">
    <div class="">
        <div class="fluid-top">
            <div class="searchBox">
                <!--查询条件-->
                <label class="dateInput" >
                    <span>年份</span>
                    <input type="text" name="year"   style="cursor:pointer"  readonly="readonly" title="月份" value="${year}"  id="year">
                    <i class="layui-icon layui-icon-date" style="margin-left:-25px"></i>
                </label>
            </div>
        </div>
        <div class="layui-row layui-col-space15">
            <div class="layui-col-sm8">
             <div class="layui-card">
                    <div class="layui-card-header"  style="font-weight:bold">
                        <span class="layui-time"></span>近三年专业类别成果鉴定结论数量分布
                    </div>
                    <div class="layui-card-body btn-function">
                        <div  style="height:280px;width: 100%;" id="topic_chart1"></div>
                    </div>
                    
                </div>
            </div>
            <div class="layui-col-sm4">
                <div class="layui-card">
                    <div class="layui-card-header" style="font-weight:bold">
                        <span class="layui-time"></span>近三年专业类别成果鉴定结论数量论占比分
                    </div>
                    <div class="layui-row-main">
                        <div class="main-chart" id="topic_chart2" style="height:280px;width: 96%;"></div>
                    </div>
                </div>
            </div>
        </div>
        
        
        <div class="layui-row layui-col-space15">
            <div class="layui-col-sm8">
                <div class="layui-card">
                    <div class="layui-card-header" style="font-weight:bold">
                        <span class="layui-time"></span>成果鉴定结论数量按研究院分布情况分析
                    </div>
                    <div class="layui-row-main">
                        <div class="main-chart" id="topic_chart3" style="height:280px;width: 100%;"></div>
                    </div>
                </div>
            </div>
            <div class="layui-col-sm4">
                <div class="layui-card">
                    <div class="layui-card-header" style="font-weight:bold">
                        <span class="layui-time"></span>成果鉴定结论数量按研究院占比分析
                    </div>
                    <div class="layui-row-main">
                        <div class="main-chart" id="topic_chart4" style="height:280px;width: 96%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--表格数据操作js-->
<script src="/common/js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/layuiadmin/layui/layui.js"></script>
<script type="text/javascript" src="/plugins/echarts/echarts.min.js"></script>
<script type="text/javascript" src="/layuiadmin/modules/bmap.js"></script>
<script type="text/javascript" src="/plugins/echarts/walden.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_line.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_bar.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_pie.js"></script>
<script type="text/javascript" src="/stp/hana/home/direct_depart/direct_common.js"></script>
<script src="/stp/hana/common/hana_common.js"></script>
<script type="text/javascript">
var param=JSON.parse(window.localStorage.getItem("param"));
var functionId=param.id;


layui.config({
	 base: '/layuiadmin/lib/extend/'
}).use(['jquery','form', 'laydate','table','laypage'], function(){
	  $ = layui.jquery
      ,table = layui.table
      ,form = layui.form
      ,laydate = layui.laydate
	  form.render(null, 'component-form-group');
      var yearValY=$("#year").val();
      $(".layui-time").html(yearValY+"年");
      
      
      laydate.render({
     	 elem: '#year' ,type: 'year'
         ,done: function(value, date, endDate){
             $(".layui-time").html(date.year);
             $("#year").val(date.year); 
             search_Event();
         }
     });
      
      
});


function init()
{
	
		var v_date=(new Date()).getTime();
		var year=$('#year').val();
	    $(".layui-time").html(year+"年");
	    
	       var  yAxis= [
	            {
	            	 type: 'value',
	                 name: '数量（个）',
	                 position: 'left',
	                 axisLabel: {
	                     formatter: '{value}'
	                 }
	            }
	        ];

    	var chart1_url="/more-dimension/achievements_trend_analysis_01?type=1&nd="+year+"&v_date="+v_date;
    	var color=["#D5A769","#8B8DB9"]
    	var echart1=load_mutl_bar_down(chart1_url,"topic_chart1","","",yAxis,'',color);
    	echart1.on('click', function (params) {
    		var xName=params.name;
    		var legentName=params.seriesName;
			var nd=$('#year').val();
    		if(legentName=='今年数量')
   			{
   			
   			}
    		if(legentName=='去年数量')
   			{
    			nd=parseInt(nd)-1;
   			}
    		if(legentName=='前年数量')
   			{
    			nd=parseInt(nd)-2;
   			}
    		//alert(nd);
    		parent.layui.index.openTabsPage("/one_level_main/achievement_table_new?zy=" + xName + "&nd=" +nd + "&groupFlag=jdh,sqjddw", "科技成果详情");
        });
    	
    	var url_8="/more-dimension/achievements_trend_analysis_01?type=2&nd="+year+"&v_date="+v_date;
    	var echart8=loadPie_02(url_8,"topic_chart2","","");
    	echart8.on('click', function (params) {
    		var xName=params.name;
    		var legentName=params.seriesName;
    		parent.layui.index.openTabsPage("/one_level_main/achievement_table_new?zy=" + xName + "&nd=" + $('#year').val() + "&groupFlag=jdh,sqjddw", "科技成果详情");
        });
    	
    	
    	

    	var chart1_url="/more-dimension/achievements_trend_analysis_02?type=1&nd="+year+"&v_date="+v_date;
    	var echart1=load_mutl_bar_down(chart1_url,"topic_chart3","","",yAxis,'',color);
    	echart1.on('click', function (params) {
    		var xName=params.name;
    		var legentName=params.seriesName;
    		parent.layui.index.openTabsPage("/one_level_main/achievement_table_new?define1=" + xName + "&nd=" + $('#year').val() + "&define3=直属研究院&define11=股份公司&groupFlag=jdh,sqjddw", "科技成果详情");
        });
    	
    	var url_8="/more-dimension/achievements_trend_analysis_02?type=2&nd="+year+"&v_date="+v_date;
    	var echart8=loadPie_02(url_8,"topic_chart4","","");
    	echart8.on('click', function (params) {
    		var xName=params.name;
    		var legentName=params.seriesName;
    		parent.layui.index.openTabsPage("/one_level_main/achievement_table_new?define1=" + xName + "&nd=" + $('#year').val() + "&define3=直属研究院&define11=股份公司&groupFlag=jdh,sqjddw", "科技成果详情");
        });
    	
    	
    	
    	
			
}		

init();  
function search_Event()
{
	init();
}        
        
</script>
</body>
</html>
