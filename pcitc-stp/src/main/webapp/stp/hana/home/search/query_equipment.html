<!DOCTYPE html>
<html style="background: none;">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/adminStp.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/mainStp.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/common.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/second.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/modules/base.js" media="all">
    <style>
        .layui-table-page{border-width: 1px 0 1px 0;}
    </style>
</head>
<body>
<input type="hidden" name="keyword" value="${keyword}" id="keyword">
<div class="tableBox" style="margin-top: 10px;">
    <table id="processdef_table_02" class="layui-hide" lay-filter="processdef_table_02"></table>
</div>
<div class="relevant">

</div>
<script src="/common/js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/layuiadmin/layui/layui.js"></script>
<script type="text/javascript" src="/plugins/echarts/echarts.min.js"></script>
<script type="text/javascript" src="/plugins/echarts/walden.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_line.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_bar.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_pie.js"></script>
<script type="text/javascript" src="/stp/hana/home/direct_depart/direct_common.js"></script>

<script type="text/javascript">
    var table, selectRowData;

    layui.use(['jquery', 'table', 'laypage', 'form', 'layer', 'laytpl', 'laydate', "publicMethods"], function () {
        table = layui.table,
            $ = layui.jquery,
            layer = layui.layer,
            laydate = layui.laydate,
            form = layui.form,
            laypage = layui.laypage;
        publicMethods = layui.publicMethods;
        //加载表格
        renderTable();
        //移除表头的复选框,去掉全选
        $(".layui-table-header table thead th input").remove();
        //监听表格双击事件
        table.on('row(processdef_table_02)', function (obj) {
            var temUrl = '/sre-project-basic/get/' + obj.data.id;
            layer.open({
                title:"详情"
                ,skin: 'layui-layer-lan'
                ,shadeClose: false
                ,type: 2
                ,fixed: false
                //若使用小窗口形式，则修改 maxmin 值为 true，则注释掉area:[100%,100%]属性,同时设置area: ['900px', '450px']
                ,maxmin : true
                ,area : [ '70%', '90%' ]
                ,content:  temUrl
            });
        });

        function renderTable() {
            //渲染
            table.render({
                elem: '#processdef_table_02',
                url: '/fullSearch/getTableSearchEquipment',
                method: "POST",
                where: {
                    param: {
                        "keywords": "${keyword}"
                    }
                },
                limit: 15,
                id: 'processdef_table_02',
                // height: commonDislodgeTable(),
                page: {
                    count: 500, //数据总数，从服务端得到
                    groups: 5,
                    limits: [15, 30, 45, 60],
                    layout: ['count', 'limit', 'prev', 'page', 'next', 'skip'], //自定义分页布局
                    first: '首页', //不显示首页
                    last: '尾页', //不显示尾页
                    // theme: '#0F9EE0'
                },

                cols: [[
                    {type: 'checkbox', event: 'changeEvents', width: 55},
                    {title: '序号', type: 'numbers', width: 55},
                    {
                        field: 'name', title: '课题名称', style: 'cursor: pointer;', align: 'left', width: '40%'
                        // , templet: function (d) {
                        //     return '<span onclick="view_project(\'' + d.id + '\')" style="color:#1890ff">' + d.name + '</span>'
                        // }, sort: true
                    },
                    {field: 'leadUnitName', title: '单位', style: 'cursor: pointer;', align: 'left', sort: true, width: '30%'},
                    {field: 'setupYear', title: '年度', style: 'cursor: pointer;', align: 'center', sort: true}
                ]],
                done: function (res, curr, count) {
                    parent.$("#equipment").html(count);
                    // 点击行联动选择框--单选
                    $('.layui-table-box').find('.layui-table-body').find("table").find("tbody").children("tr").on('click', function () {
                        var index = parseInt($(this).index() + 1);
                        $('tr').removeClass('layui-table-click');
                        $(this).addClass('layui-table-click');
                        $('tr').find("td").find(".layui-unselect").removeClass("layui-form-checked")
                        $('tr:eq(' + index + ')').find("td").eq(0).find(".layui-unselect").addClass("layui-form-checked");
                        selectRowData = res.data[index - 1];
                        var auditStatus = selectRowData.auditStatus;
                    });
                }
            });
        }
    });

</script>
</body>
</html>