<!DOCTYPE html>
<html style="background: none;">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/adminStp.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/mainStp.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/common.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/second.css" media="all">
    <style>
        .layui-table-click,.layui-table-hover,.layui-table tbody tr:hover{background: none;}
        .layui-table-header{display: none;}
        .layui-table-view,.layui-table-page,.tableBox table tr td{border: none;}
        .layui-table-body{margin-top: 20px;}
        .layui-table-cell{height: auto;margin-bottom: 10px;}
        p{width: 500px;height: auto;overflow: hidden;white-space: normal;/*text-overflow: ellipsis;*/
            font-size: 13px;word-break:break-all;word-wrap:break-word;line-height: 20px;}
        .layui-table-page{margin-bottom: 20px;}
        .tableBox,.searchBox{padding-left:18px;margin: 0 auto;}
        .tableBox{width: 50%;float: left;margin-bottom: 70px;}
        .searchBox{margin-top: 20px;}
        .relevant{width: 34%;float: right;margin-right: 20px;}
        .hotspot>.item{width: 100%;text-align: left;padding: 0;padding-top: 10px;}
        .hotspot>.item a{font-size: 14px;color: #1890ff;line-height: 26px;}
        .hotspot>.item a:hover{text-decoration:underline;}
        .c-nameC{height: 0px;}
    </style>
</head>
<body>
<input type="hidden" name="keyword"  value="${keyword}"   id="keyword">
<input type="hidden" name="companyCode"  value="${companyCode}"   id="companyCode">
<div class="searchBox" hidden>
    <label class="dateInput">
        <span>年月</span>
        <input type="text" name="month" placeholder="请选择年月" title="年月" value="${month}"  autocomplete="off" class="form-control" id="month">
    </label>
    <!--按钮组-->
    <!--<div class="btnGroup">
        <button class="layui-btn layui-btn-sm fontColor-white btn_search btnMyBgImg"
                onclick="search_Event()">查询</button>
    </div>-->
    <!--<div class="btnGroup">-->
    <!--<button id="knowledge_table" class="layui-btn layui-btn-sm fontColor-blue borderColor-blue  btnMyBgImg btn_details"-->
    <!--&gt;详情</button>-->
    <!--</div>-->
</div>
<div class="tableBox">
    <table id="processdef_table_02" class="layui-hide" lay-filter="processdef_table_02"></table>
</div>
<div class="relevant">
    <p>相关内容</p>
    <div class="relevant-cont">
        <div class="item">
            <img src="/layuiadmin/layui/images/search-relevant.jpg"/>
            <a href="javascript:;">合同签订率</a>
        </div>
        <div class="item">
            <img src="/layuiadmin/layui/images/search-relevant.jpg"/>
            <a href="javascript:;">合同签订率</a>
        </div>
        <div class="item">
            <img src="/layuiadmin/layui/images/search-relevant.jpg"/>
            <a href="javascript:;">合同签订率</a>
        </div>
        <div class="item">
            <img src="/layuiadmin/layui/images/search-relevant.jpg"/>
            <a href="javascript:;">合同签订率</a>
        </div>
        <div class="item">
            <img src="/layuiadmin/layui/images/search-relevant.jpg"/>
            <a href="javascript:;">合同签订率</a>
        </div>
        <div class="item">
            <img src="/layuiadmin/layui/images/search-relevant.jpg"/>
            <a href="javascript:;">合同签订率</a>
        </div>
    </div>
    <!--<p>搜索热点</p>
    <div class="relevant-cont hotspot">
        <div class="item">
            <a href="javascript:;">动载条件下水泥环密封失效机理与控制方法</a>
        </div>
        <div class="item">
            <a href="javascript:;">动载条件下水泥环密封失效机理与控制方法控制方法</a>
        </div>
        <div class="item">
            <a href="javascript:;">动载条件下水泥环密封失效机理与控制方法控制方法</a>
        </div>
        <div class="item">
            <a href="javascript:;">动载条件下水泥环密封失效机理与控制方法控制方法</a>
        </div>
        <div class="item">
            <a href="javascript:;">动载条件下水泥环密封失效机理与控制方法控制方法</a>
        </div>
        <div class="item">
            <a href="javascript:;">动载条件下水泥环密封失效机理与控制方法控制方法</a>
        </div>
    </div>-->
</div>
<script src="/common/js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/layuiadmin/layui/layui.js"></script>
<!-- <script src="/common/js/layer-v3.1.1/layer.js"></script> -->
<script type="text/javascript" src="/plugins/echarts/echarts.min.js"></script>
<script type="text/javascript" src="/plugins/echarts/walden.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_line.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_bar.js"></script>
<script type="text/javascript" src="/stp/hana/common/stp_common_pie.js"></script>
<script type="text/javascript" src="/stp/hana/home/direct_depart/direct_common.js"></script>

<script type="text/javascript">
    layui.config({
        base: '/layuiadmin/lib/extend/'
    }).extend({
        treeGridCom:'treeGridCom'
    }).use(['jquery','form', 'laydate','treeGridCom','table','laypage'], function(){
        var $=layui.jquery,table=layui.table;
        var month=$("#month").val();
        var companyCode=$("#companyCode").val();
        table.render({
            elem: '#processdef_table_02' //表格容器
            , url: '/fullSearch/getTableSearchEquipment?month='+month+"&companyCode="+companyCode+"&keyword="+$("#keyword").val()
            , limit: 15 //每页默认显示的数量
            , id: 'processdef_table_02'
            ,page: {
                groups: 5,
                limits: [15,30,45,60],
                layout: ['count', 'limit', 'prev', 'page', 'next', 'skip'], //自定义分页布局
                first: '首页', //不显示首页
                last: '尾页', //不显示尾页
                theme: '#0F9EE0'
            }
            ,cols: [[
                {field:'LAY_TABLE_INDEX',title:'年度',
                    templet:  '<div>{{ layui.laytpl.search(d) }}</div>' },
            ]],
            done: function(res, curr, count){
                //merge(res);
                parent.$("#equipment").html(count);
            }
        });
        function merge(res) {

            var data = res.data;
            var mergeIndex = 0;//定位需要添加合并属性的行数
            var mark = 1; //这里涉及到简单的运算，mark是计算每次需要合并的格子数
            var columsName = ['extend01','extend02'];//需要合并的列名称
            var columsIndex = [0,1];//需要合并的列索引值

            for (var k = 0; k < columsName.length; k++) { //这里循环所有要合并的列
                var trArr = $(".layui-table-body>.layui-table").find("tr");//所有行
                for (var i = 1; i < res.data.length; i++) { //这里循环表格当前的数据
                    var tdCurArr = trArr.eq(i).find("td").eq(columsIndex[k]);//获取当前行的当前列
                    var tdPreArr = trArr.eq(mergeIndex).find("td").eq(columsIndex[k]);//获取相同列的第一列

                    if (data[i][columsName[k]] === data[i-1][columsName[k]]) { //后一行的值与前一行的值做比较，相同就需要合并
                        mark += 1;
                        tdPreArr.each(function () {//相同列的第一列增加rowspan属性
                            $(this).attr("rowspan", mark);
                        });
                        tdCurArr.each(function () {//当前行隐藏
                            $(this).css("display", "none");
                        });
                    }else {
                        mergeIndex = i;
                        mark = 1;//一旦前后两行的值不一样了，那么需要合并的格子数mark就需要重新计算
                    }
                }
                mergeIndex = 0;
                mark = 1;
            }
        }
    });

</script>
</body>
</html>