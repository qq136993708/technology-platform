<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>科研人才</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="Shortcut Icon" href="/layuiadmin/layui/images/favicon.ico" />
    <link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/common.css" media="all">
    <link rel="stylesheet" href="/layuiadmin/style/second.css" media="all">
    <script src="/layuiadmin/layui/layui.js"></script>
    <script src="/layuiadmin/modules/cnchar.min.js"></script>
</head>
<body>
    <div class="layui-fluid layui-personnel">
        <!-- <div class="layui-main-personnel">
           <div class="distribution">
               <h4>科研人才分布</h4>
               <div class="layui-row layui-col-space15">
                   <div class="layui-col-xs4 layui-col-sm4 layui-col-md4" style="padding-top: 20px;">
                       <img src="/layuiadmin/layui/images/icon-char-left.png" alt="">
                   </div>
                   <div class="layui-col-xs8 layui-col-sm8 layui-col-md8">
                       <div class="text-total">
                           <span>院士:<span class="text-total-blue" id="chart1_01">11</span>人</span>
                           <span>集团首席科学家:<span class="text-total-blue" id="chart1_02">33</span>人</span>
                           <span>集团高级专家:<span class="text-total-blue" id="chart1_03">12</span>人</span>
                           <span>首席高级专家:<span class="text-total-blue" id="chart1_04">54</span>人</span>
                       </div>
                       <img src="/layuiadmin/layui/images/icon-char-right.png" alt="">
                   </div>
               </div>
           </div>
        </div> -->
        <div class="layui-main-personnel">
            <div class="academician">
                <h4>院士风采</h4>
                <div class="layui-row">
                    <ul>

                    </ul>
                </div>
            </div>
        </div>
        <div class="layui-main-personnel">
            <div class="expert">
                <h4>集团首席专家</h4>
                <p>姓名按姓氏笔画排列</p>
                <div class="layui-expert">
                    <ul id="expert2">

                    </ul>
                </div>
            </div>
        </div>
        <div class="layui-main-personnel">
            <div class="expert">
                <h4>集团高级专家</h4>
                <p>姓名按姓氏笔画排列</p>
                <div class="layui-expert">
                    <ul id="expert3">
                    </ul>
                </div>
            </div>
        </div>
        <!-- <div class="layui-main-personnel">
            <div class="expert">
                <h4>首席高级专家</h4>
                <p>姓名按姓氏笔画排列</p>
                <div class="layui-expert">
                    <ul>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                        <li><a href="javascript:;">陈专家</a></li>
                    </ul>
                </div>
            </div>
        </div> -->
        <div class="layui-main-personnel">
            <div class="expert">
                <h4>技术专家</h4>
                <p>姓名按姓氏笔画排列</p>
                <div class="layui-expert">
                    <ul id="expert1">
                    </ul>
                </div>
            </div>
        </div>

    </div>
    <script>
        layui.use(['jquery', 'table', 'layer', 'laydate','publicMethods'], function () {
            var $ = layui.jquery, table = layui.table, laydate = layui.laydate,publicMethods= layui.publicMethods;
            publicMethods.ajaxAsyncPost("/zjkBaseInfo/zjk-ys-list", null, function (data) {
            	var content = "";
            	$.each(data,function(i,d){
            		content +=   
           			'<li>'+
	                    '<div>'+
	                        '<div class="expert-i">'+
	                            '<img dataType="headImg" id="'+d.dataId+'" src="" alt="" height="110">'+
	                        '</div>'+
	                        '<div class="expert-t">'+d.expertName+'</div>'+
	                        '<div class="expert-s">'+d.expertProfessionalFieldName+'</div>'+
	                        '<div class="expert-ab">'+d.userDesc+'</div>'+
	                        '<div class="expert-a">'+
	                            '<a href="/instituteIndex?url=/expertController/expertDetail?expertId='+d.dataId+'&display=1"  target="_blank">查看详情</a>'+
	                        '</div>'+
	                    '</div>'+
	                '</li>';
            	});
            	$(".academician ul").html(content);
                 //获取图片
                 getFileResultImg();
            });
            publicMethods.ajaxGet("/expertController/queryAllExpert", null, function (data) {
                var expert1 = "";
                var expert2 = "";
                var expert3 = "";
                var  e1 = 0;
                var  e2 = 0;
                var  e3 = 0;
                
                // 按笔画排序
                var expertBH1 = [];
                var expertBH2 = [];
                var expertBH3 = [];
                for (let i = 0,j=data.length; i <j; i++) {
                    var bak3 = data[i].bak3;
                    if(bak3=="ZJK_ZJLX_JSLJRW"){
                        //e1++;
                        //expert1 = expert1+"<li><a href=\"/expertController/expertDetailIndex?dataId="+data[i].data_id+"\" target='_blank'>"+data[i].expert_name+"</a></li>\n";
                		var obj = {};
                		// 存储笔画
                		obj.stroke = data[i].expert_name.substring(0,1).stroke();
                		obj.data = data[i];
                		expertBH1.push(obj);
                    }else if(bak3=="ZJK_ZJLX_JTSXZJ"){
                    	var obj = {};
                		// 存储笔画
                		obj.stroke = data[i].expert_name.substring(0,1).stroke();
                		obj.data = data[i];
                		expertBH2.push(obj);
                    }else if(bak3=="ZJK_ZJLX_JTGJZJ"){
                    	var obj = {};
                		// 存储笔画
                		obj.stroke = data[i].expert_name.substring(0,1).stroke();
                		obj.data = data[i];
                		expertBH3.push(obj);
                    }
                }
                
                // 排序 使用 expertBH1.stroke 也就是笔画排序
            	expertBH1.sort(function(a,b){
            		return a.stroke - b.stroke;
            	});
            	expertBH2.sort(function(a,b){
            		return a.stroke - b.stroke;
            	});
            	expertBH3.sort(function(a,b){
            		return a.stroke - b.stroke;
            	});
            	for (var i = 0; i <expertBH1.length; i++) {
            		e1++;
            	    expert1 = expert1+"<li><a href=\"/instituteIndex?url=/expertController/expertDetail?display=1&expertId="+expertBH1[i].data.data_id+"\" target='_blank'>"+expertBH1[i].data.expert_name+"</a></li>\n";
            	}
            	for (var i = 0; i <expertBH2.length; i++) {
            		e2++;
            	    expert2 = expert2+"<li><a href=\"/instituteIndex?url=/expertController/expertDetail?display=1&expertId="+expertBH2[i].data.data_id+"\" target='_blank'>"+expertBH2[i].data.expert_name+"</a></li>\n";
            	}
            	for (var i = 0; i <expertBH3.length; i++) {
            		e1++;
            	    expert3 = expert3+"<li><a href=\"/instituteIndex?url=/expertController/expertDetail?display=1&expertId="+expertBH3[i].data.data_id+"\" target='_blank'>"+expertBH3[i].data.expert_name+"</a></li>\n";
            	}
                
                $("#chart1_04").html(e1);
                $("#chart1_02").html(e2);
                $("#chart1_03").html(e3);
                
                //console.info(expert1);
                $("#expert1").append(expert1);
                $("#expert2").append(expert2);
                $("#expert3").append(expert3);
            });
            function getFileResultImg() {
                //获取通用url
                var ids = "";
                $.each($('img[dataType="headImg"]'), function (i, d) {
                    ids=ids+","+$(this).attr("id");
                });
                var ret = getFileResult(ids);
                for (let i = 0; i < ret.list.length; i++) {
                    $("#"+ret.list[i].dataid).attr("src",ret.list[i].filePath);
                }
            }
            function photoContent(picId) {
                var ret = getFileResult(picId);
                if (ret != null && ret.list.length > 0) {
                    picId = ret.list[0].id;
                }
                var base64 = "";
                $.ajax({
                    type: 'get',
                    dataType: 'text',
                    async: false,
                    url: '/sysfile/viewPic/' + picId,
                    success: function (data) {
                        base64 = data;
                    },
                    error: function (e) {
                        alert("出错了");
                    }
                });
                return base64;
            }

            ////加载图片
            function getFileResult(fileIds) {
                var ret = null;
                ajaxFile("/sysfile/getFilesLayuiByFormId", {fileIds: fileIds}, function (result) {
                    ret = result;
                });
                return ret;
            }
            function ajaxFile(url, data, callback) {
                var result = null;
                $.ajax({
                    type: 'post',
                    async: false,
                    url: url,
                    data: data,
                    dataType: 'json',
                    success: function (data, status) {
                        result = data;
                        if (callback) {
                            callback.call(this, data, status);
                        }
                    },
                    error: function (err, err1, err2) {
                        console.log("ajaxPost发生异常，请仔细检查请求url是否正确");
                    }
                });
                return result;
            }
        });
    </script>
</body>
</html>