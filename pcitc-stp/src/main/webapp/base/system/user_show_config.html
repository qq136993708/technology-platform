<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>首页</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
<link rel="Shortcut Icon" href="/layuiadmin/layui/images/favicon.ico" />
<link rel="stylesheet" href="/layuiadmin/layui/css/layui.css" media="all">
<link rel="stylesheet" href="/layuiadmin/style/adminStp.css" media="all">
<link rel="stylesheet" href="/layuiadmin/style/oneLevel.css" media="all">
<link rel="stylesheet" href="/common/css/echart-common.css">
<script src="/layuiadmin/layui/layui.js"></script>
<style>
html {
	background: #fff;
}
</style>
</head>
<body>
	<div class="module">
		<p>已选功能</p>
		<div class="selected selectOption">
			<div class="selectedProject">
				<p class="title">统计模块</p>
				<div class="option">
					<#if show1List?exists> <#list show1List as s1>
					<p>
						${s1.showName}
						<span></span>
					</p>
					</#list> </#if>
				</div>
			</div>
			<div class="selectedTechnical">
				<p class="title">业务模块</p>
				<div class="option">
					<#if show2List?exists> <#list show2List as s2>
					<p>
						${s2.showName}
						<span></span>
					</p>
					</#list> </#if>
				</div>
			</div>
		</div>
		<p>未选功能</p>
		<div class="unselected selectOption">
			<div class="unselectedProject">
				<p class="title">统计模块</p>
				<div class="option">
					<#if config1List?exists> <#list config1List as c1>
					<p>
						${c1.moduleName}
					</p>
					</#list> </#if>
				</div>
			</div>
			<div class="unselectedTechnical">
				<p class="title">业务模块</p>
				<div class="option">
					<#if config2List?exists> <#list config2List as c2>
					<p>
						${c2.name}
					</p>
					</#list> </#if>
				</div>
			</div>
		</div>
	</div>
	<div class="form-bottom moduleB">
		<div class="form-bottom-btns">
			<button type="button" class="layui-btn-c" id="cancel">取消</button>
			<button class="layui-btn-d" id="confirm">确定</button>
		</div>
	</div>
	<script>
		layui.use([ 'jquery', 'publicMethods' ], function() {
			var $ = layui.jquery, publicMethods = layui.publicMethods;
			/* $("#leader").click(function () {
			     var data={"power":"1", "name":"领导讲话","color":"#f10033","img":"/layuiadmin/layui/images/icon-party.png","class":"layui-col-md3","id":"","spareId":null};
			     publicMethods.moduleConfig(data);
			 });
			 $("#home_budget").click(function () {
			     var data=
			         {"power":"3", "name":"科研装备","color":"#488c34","img":"/layuiadmin/layui/images/textTopThree.png","class":"layui-col-md3","id":"equipment","spareId":"K0BNGLFPHJECB_t"};
			     publicMethods.moduleConfig(data);
			 });*/
			$(".module .selectOption .option").each(function (i, val) {
				if($(this).find("p").length==0){
				    $(this).parent().css("margin-bottom","15px");
				}
            });
			dele();
			$(".module").css("height", parent.$(".layui-layer-content").height() - 61 + "px");
            addP();
			$("#confirm").click(function() {
				//获取选中项
				var selectedOP = [];
				$(".selected .option p").each(function() {
					selectedOP.push($(this).text())
				});
				$.ajax({
					type : 'GET',
					dataType : 'json',
					headers : {
						'Content-Type' : 'application/json;charset=UTF-8',
					},
					url : "/layuiadmin/json/data1.json",
					success : function(data, status) {
						$.each(selectedOP, function(index, d) {
							$.each(data.data, function(index, dt) {
								if (dt.name == d) {
									publicMethods.moduleConfig(dt);
								}
							});
						})
						if (parent.$("#moduleConfig li").length < 16) {
							var htmlA = "<li class='layui-col-md3'>" + "           <div class='layui-col-md' id='layui-add'>" + "               <div class='layui-add'>"
									+ "                   <img src='/layuiadmin/layui/images/icon-puls.png'/>" + "               </div>" + "           </div>"
									+ "      </li>";
							parent.$("#moduleConfig").append(htmlA);
						} else {
							var htmlA = "<li class='layui-col-md3'>" + "           <div class='layui-col-md' id='layui-add'>" + "               <div class='layui-add'>"
									+ "                   <img src='/layuiadmin/layui/images/icon-puls.png'/>" + "               </div>" + "           </div>"
									+ "      </li>";
							parent.$(".layui-row-special ul").append(htmlA);
						}
						parent.addLast();
						//publicMethods.moduleConfigs(data.data);
					},
					error : function(err, err1, err2) {
						console.log("ajaxPost发生异常，请仔细检查请求url是否正确");
					}
				});
				var index = parent.layer.getFrameIndex(window.name);
				parent.layer.close(index);
			});
			$("#cancel").click(function() {
				var index = parent.layer.getFrameIndex(window.name);
				parent.layer.close(index);
			});
			function addP() {
                $(".unselected .option p").unbind("click").on("click",function() {
                    if ($(this).attr("class") != "layui-this") {
                        var index = $(this).parent().parent().index();
                        var html = $(this).html();
                        $(this).remove();
                        $(".selected>div").eq(index).find(".option").append("<p>" + html + "<span></span></p>");
                        dele();
                    }
                });
            }
			function dele() {
				$(".option p span").click(function() {
					var indexS = $(this).parents(".option").parent().index();
					var htmlS = $.trim($(this).parent().text());
					var htmlClass=$(this).parents(".option").parent().attr("class");
					$(".unselected .un"+htmlClass+" .option").append("<p>"+htmlS+"</p>");
                    addP();
					$(this).parent().remove();
					/*$(".unselected>div").eq(indexS).find(".option p").each(function() {
						if (htmlS.indexOf($(this).html()) != -1) {
							$(this).removeClass("layui-this");
						}
					});*/
				});
			}
		});
	</script>
</body>
</html>